<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Geoestat√≠stica | Elias M. Costa</title>
    <link>https://eliasmcosta.netlify.app/category/geoestatistica/</link>
      <atom:link href="https://eliasmcosta.netlify.app/category/geoestatistica/index.xml" rel="self" type="application/rss+xml" />
    <description>Geoestat√≠stica</description>
    <generator>Wowchemy (https://wowchemy.com)</generator><language>pt-br</language><lastBuildDate>Sat, 20 Aug 2022 12:22:36 -0300</lastBuildDate>
    <image>
      <url>https://eliasmcosta.netlify.app/media/icon_hu7a95d294645c46fa741ff9356371500f_596140_512x512_fill_lanczos_center_3.png</url>
      <title>Geoestat√≠stica</title>
      <link>https://eliasmcosta.netlify.app/category/geoestatistica/</link>
    </image>
    
    <item>
      <title>Geoestat√≠stica aplicada a agricultura de precis√£o</title>
      <link>https://eliasmcosta.netlify.app/post/geo/</link>
      <pubDate>Sat, 20 Aug 2022 12:22:36 -0300</pubDate>
      <guid>https://eliasmcosta.netlify.app/post/geo/</guid>
      <description>


&lt;div id=&#34;introdu√ß√£o&#34; class=&#34;section level1&#34;&gt;
&lt;h1&gt;Introdu√ß√£o&lt;/h1&gt;
&lt;p&gt;A geoestat√≠stica como conhecemos hoje come√ßou com os trabalhos de &lt;span class=&#34;citation&#34;&gt;Krige (&lt;a href=&#34;#ref-Krige1951&#34; role=&#34;doc-biblioref&#34;&gt;1951&lt;/a&gt;)&lt;/span&gt;. Para ele somente a informa√ß√£o dada pela vari√¢ncia n√£o seria suficiente para explicar o fen√¥meno em estudo. Para tal, seria necess√°rio levar em considera√ß√£o a dist√¢ncia entre as observa√ß√µes. A partir da√≠ surge o conceito da &lt;code&gt;geoestat√≠stica&lt;/code&gt;, que leva em considera√ß√£o a &lt;code&gt;localiza√ß√£o geogr√°fica&lt;/code&gt; e a &lt;code&gt;depend√™ncia espacial&lt;/code&gt; entre amostras.
&lt;span class=&#34;citation&#34;&gt;Matheron (&lt;a href=&#34;#ref-Matheron1963&#34; role=&#34;doc-biblioref&#34;&gt;1963&lt;/a&gt;)&lt;/span&gt; e &lt;span class=&#34;citation&#34;&gt;Matheron (&lt;a href=&#34;#ref-Matheron1971&#34; role=&#34;doc-biblioref&#34;&gt;1971&lt;/a&gt;)&lt;/span&gt; , baseado-se nas observa√ß√µes de Krige, desenvolveu a teoria das &lt;code&gt;vari√°veis regionalizadas&lt;/code&gt;. Uma vari√°vel regionalizada √© uma fun√ß√£o num√©rica com distribui√ß√£o espacial, que varia de um ponto a outro com continuidade aparente, mas cujas varia√ß√µes n√£o podem ser representadas por uma fun√ß√£o matem√°tica simples.
A teoria das vari√°veis regionalizadas pressup√µe que a varia√ß√£o de uma vari√°vel pode ser expressa pela soma de tr√™s componentes: a) uma componente estrutural, associada a um valor m√©dio constante ou a uma tend√™ncia constante; b) uma componente aleat√≥ria, espacialmente correlacionada; e c) um ru√≠do aleat√≥rio ou erro residual.
Assim um valor da vari√°vel Z em um local x √© dado por:&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[ Z(x)=m(x)+\varepsilon‚Ä≤(x)+\varepsilon‚Ä≤‚Ä≤ \]&lt;/span&gt;
onde: m(&lt;strong&gt;x&lt;/strong&gt;) √© uma fun√ß√£o determin√≠stica que descreve a componente estrutural de Z
em x; Œµ‚Ä≤(&lt;strong&gt;x&lt;/strong&gt;) √© um termo estoc√°stico, que varia localmente e depende espacialmente de
m(&lt;strong&gt;x&lt;/strong&gt;); Œµ‚Ä≤‚Ä≤ √© um ru√≠do aleat√≥rio n√£o correlacionado, com distribui√ß√£o normal com
m√©dia zero e vari√¢ncia œÉ2&lt;/p&gt;
&lt;p&gt;Um dos modelos mais simplistas dessa varia√ß√£o √© o calculado pelo &lt;code&gt;inverso do quadrado da dist√¢ncia&lt;/code&gt; que assume que qualquer atributo do solo varia a taxa fixa do inverso da dist√¢ncia, o que na pr√°tica n√£o √© bem verdade, mas em muitos casos esse modelo atende a necessidade.&lt;/p&gt;
&lt;div id=&#34;variograma&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Variograma&lt;/h2&gt;
&lt;p&gt;O variograma √© uma ferramenta b√°sica de suporte √†s t√©cnicas de krigagem, que permite representar quantitativamente a varia√ß√£o de um fen√¥meno regionalizado no espa√ßo. Considere duas vari√°veis regionalizadas, X e Y, onde X = Z(x) e Y = Z(x+h). Neste caso, referem-se ao mesmo atributo medido em duas posi√ß√µes diferentes.&lt;/p&gt;
&lt;p&gt;O n√≠vel de depend√™ncia entre essas duas vari√°veis regionalizadas, X e Y, √© representado pelo variograma, 2Œ≥(&lt;strong&gt;h&lt;/strong&gt;), o qual √© definido como a esperan√ßa matem√°tica do quadrado da diferen√ßa entre os valores de pontos no espa√ßo, separados pelo vetor dist√¢ncia &lt;strong&gt;h&lt;/strong&gt;, isto √©,&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[ 2Œ≥(h) = E{[Z(x)-Z(x+h)] 2 } = Var[Z(x)-Z(x+h)]\]&lt;/span&gt;
Atrav√©s de uma amostra z(x i ), i=1, 2, /home/elias/MEGA/Geo., n, o variograma pode ser estimado por&lt;/p&gt;
&lt;p&gt;&lt;span class=&#34;math display&#34;&gt;\[ 2≈∂(h)=\frac{1}{N(h)}\sum^{N(h)}_{i=1}[Z(x_i)-Z(X_i+h)]¬≤\]&lt;/span&gt;
onde:
- 2≈∂(&lt;strong&gt;h&lt;/strong&gt;) - √© o variograma estimado;
- N(h) - √© o n√∫mero de pares de valores medidos, z(&lt;strong&gt;xi&lt;/strong&gt;) e z(&lt;strong&gt;xi+h&lt;/strong&gt;), separados por um vetor dist√¢ncia &lt;strong&gt;h&lt;/strong&gt;;
- z(xi) e z(xi +h), - s√£o valores da i-√©sima observa√ß√£o da vari√°vel regionalizada, coletados nos pontos &lt;strong&gt;xi&lt;/strong&gt; e &lt;strong&gt;xi+h&lt;/strong&gt; (i = 1, /home/elias/MEGA/Geo., n), separados pelo vetor &lt;strong&gt;h&lt;/strong&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;par√¢metros-do-semivariograma&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Par√¢metros do semivariograma&lt;/h2&gt;
&lt;p&gt;O seu padr√£o representa o que, intuitivamente, se espera de dados de campo, isto √©, que as diferen√ßas {Z(&lt;strong&gt;xi&lt;/strong&gt;) - Z(&lt;strong&gt;xi+h&lt;/strong&gt;)} decres√ßam √† medida que &lt;strong&gt;h&lt;/strong&gt;, a dist√¢ncia que os separa decresce. √â esperado que observa√ß√µes mais pr√≥ximas geograficamente tenham um comportamento mais semelhante entre si do que aquelas separadas por maiores dist√¢ncias. Desta maneira, √© esperado que Œ≥(&lt;strong&gt;h&lt;/strong&gt;) aumente com a dist√¢ncia &lt;strong&gt;h&lt;/strong&gt;.&lt;/p&gt;
&lt;div class=&#34;figure&#34; style=&#34;text-align: center&#34;&gt;&lt;span style=&#34;display:block;&#34; id=&#34;fig:variogram&#34;&gt;&lt;/span&gt;
&lt;img src=&#34;semivariograma.png&#34; alt=&#34;Exemplo de Semivariograma.&#34; width=&#34;564&#34; /&gt;
&lt;p class=&#34;caption&#34;&gt;
Figure 1: Exemplo de Semivariograma.
&lt;/p&gt;
&lt;/div&gt;
&lt;ul&gt;
&lt;li&gt;Alcance (a) (range): dist√¢ncia dentro da qual as amostras apresentam-se correlacionadas espacialmente.&lt;/li&gt;
&lt;li&gt;Patamar (C) (sill): √© o valor do semivariograma correspondente a seu alcance (a).Deste ponto em diante, considera-se que n√£o existe mais depend√™ncia espacial entre as amostras, porque a vari√¢ncia da diferen√ßa entre pares de amostras (Var[Z(&lt;strong&gt;x&lt;/strong&gt;) - Z(&lt;strong&gt;x+h&lt;/strong&gt;)]) torna-se invariante com a dist√¢ncia. Pode ser definido tamb√©m como vari√¢ncia total.&lt;/li&gt;
&lt;li&gt;Efeito Pepita (C0)(nugget): A medida que &lt;strong&gt;h&lt;/strong&gt; tende para 0 (zero), g(&lt;strong&gt;h&lt;/strong&gt;) se aproxima de um valor positivo chamado Efeito Pepita (C0), que revela a descontinuidade do semivariograma para dist√¢ncias menores do que a menor dist√¢ncia entre as amostras, pode ser definido tamb√©m como vari√¢ncia residual.&lt;/li&gt;
&lt;/ul&gt;
&lt;/div&gt;
&lt;div id=&#34;estrutura-espacial-local&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Estrutura espacial local&lt;/h2&gt;
&lt;p&gt;Se consideramos as coordenadas de cada ponto √© poss√≠vel obervar uma tend√™ncia regional ou uma estrutura local dos dados, umas das formas mais simples de observar a depend√™ncia espacial √© atraves de plot espacial dos valores observados.&lt;/p&gt;
&lt;p&gt;Agora analisamos a ideia de depend√™ncia espacial local: ‚Äúmais perto no espa√ßo geogr√°fico implica mais perto no espa√ßo de atributos‚Äù. Isso pode ser verdade ou n√£o;e se for verdade, o intervalo de depend√™ncia ir√° variar, dependendo do processo f√≠sico que produziu o atributo que est√° sendo investigado, nesse caso o teor de argila do solo.
O conceito fundamental √© que deve ser entendido nesse contexto √© a &lt;code&gt;autocorrela√ß√£o espacial&lt;/code&gt;: um valor de atributo pode ser correlacionado consigo mesmo, com a for√ßa da correla√ß√£o dependendo da dist√¢ncia de separa√ß√£o (e possivelmente na dire√ß√£o). Isso deve ser evidente como uma rela√ß√£o entre a dist√¢ncia de separa√ß√£o e correla√ß√£o; para an√°lisar essas rela√ß√µes usamos o conceito de &lt;code&gt;semivari√¢ncia&lt;/code&gt; como j√° mencionado quando apresentado o semivariograma.Esse an√°lise √© feita com base no n√∫mero de pares poss√≠veis do dataset que pode ser determinado por (n √ó (n - 1))/2 pares.&lt;/p&gt;
&lt;p&gt;Quando fazemos o variograma experimental dos teores de COT, √© calculado as semivari√¢ncias &lt;em&gt;m√©dias&lt;/em&gt; dos pares de pontos versus dist√¢ncia &lt;em&gt;m√©dia&lt;/em&gt;(tamb√©m conhecido como ‚Äúlag‚Äù), com cumprimento definido pelo usu√°rio, e dist√¢ncia m√°xima de busca &lt;em&gt;cutoff&lt;/em&gt;.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;modelos-te√≥ricos&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Modelos te√≥ricos&lt;/h2&gt;
&lt;p&gt;Selecionar uma forma de modelo √© uma arte; a melhor maneira √© a partir do conhecimento do processo espacial e da forma como o modelo se ajusta ao semivariograma esperimental.
A fun√ß√£o vgm especifica um modelo de variograma. No conjunto anterior n√≥s estimamos esses par√¢metros observando o variograma emp√≠rico, ent√£o os fornecemos como par√¢metros do modelo. Observe que para cada modelo h√° um conjunto de par√¢metro que melhor se ajusta. Para fins de exemplo vamos testar os 3 principais modelos, neles teremos que ajustar o ‚Äúparcial sill‚Äù (contribui√ß√£o) &lt;code&gt;psill&lt;/code&gt; que √© o patamar menos o efeito pepita (nugget) e o alcance (range)
Poss√≠veis modelos no pacote &lt;code&gt;gstat&lt;/code&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;library(gstat)
library(sp)
library(readxl)
library(tmap)
library(raster)
print(show.vgms())&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://eliasmcosta.netlify.app/post/geo/index_files/figure-html/unnamed-chunk-2-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;data &amp;lt;- read_excel(&amp;quot;/home/elias/MEGA/Geo/data/An√°lises.xls&amp;quot;, 
                       col_types = c(&amp;quot;numeric&amp;quot;, &amp;quot;numeric&amp;quot;, &amp;quot;numeric&amp;quot;, 
                                     &amp;quot;numeric&amp;quot;, &amp;quot;numeric&amp;quot;, &amp;quot;numeric&amp;quot;, 
                                     &amp;quot;numeric&amp;quot;, &amp;quot;numeric&amp;quot;, &amp;quot;numeric&amp;quot;, 
                                     &amp;quot;numeric&amp;quot;))

## Definindo o sistema de projeto do conjunto de dados
WGS23S  = sp::CRS(&amp;quot;+proj=utm +zone=23 +south +datum=WGS84 +units=m +no_defs +ellps=WGS84 +towgs84=0,0,0&amp;quot;)

## Transformando o dataframe &amp;quot;data&amp;quot; em informa√ß√£o espacial
coordinates(data) = ~X+Y
sp::proj4string(data) = WGS23S ## Definindo sistema de coordenadas para os DADOS

plot(data)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://eliasmcosta.netlify.app/post/geo/index_files/figure-html/lendo%20e%20plotando%20os%20dados-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;## Carregando arquivo raster para uso como grid de refer?ncia na interpola√ß√£o
raster=raster::brick(&amp;quot;/home/elias/MEGA/Geo/raster/mosaico.tif&amp;quot;)
#plotRGB(raster, 1, 2, 3)
sp::proj4string(raster) = WGS23S 
#raster=projectRaster(raster, crs = WGS23S)
#plot(raster)
## Transformando o arquivo &amp;quot;raster&amp;quot; em arquivo &amp;quot;SpatialPixelsDataFrame&amp;quot; para posterior uso como grid de refer√™ncia
grid=as(raster, &amp;quot;SpatialPixelsDataFrame&amp;quot;)

############### Analisando de forma qualitativa a deped√™ncia espacial)
plot(data, asp=1, cex=4*data$ADT/max(data$ADT), pch=1)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning in max(data$ADT): no non-missing arguments to max; returning -Inf&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://eliasmcosta.netlify.app/post/geo/index_files/figure-html/lendo%20e%20plotando%20os%20dados-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;#############
# Aqui vamos ver de forma detalhada e did√°tica (passo a passo) da avalia√ß√£o de deped√™ncia espacial. Na pr√°tica n√£o h√° necessidade de seguir todos esses passos. 

n &amp;lt;- length(data$COT) # comprimento do conjunto de dados
n*(n-1)/2  ## Calculando o n√∫mero de pares de pontos&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 903&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Agora como exerc√≠cio vamos calcular a semivari√¢ncia entre os dois primeiros pontos do dataset
coordinates(data)[1,] # linha 1&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##       X       Y 
##  634733 7481375&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;coordinates(data)[2,] # linha 2&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##       X       Y 
##  634745 7481350&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;sep &amp;lt;- dist(coordinates(data)[1:2,]) # dist√¢ncia entre o ponto 1 e ponto 2
gamma &amp;lt;- 0.5 * (data$ADT[1] - data$ADT[2])^2 # semivari√¢ncia entre o ponto 1 e ponto 2

max(dist(data@coords))*2/3 # M√°xima dist√¢ncia entre os pontos, para limitar a dist√¢ncia do variograma em 2/3 da M√°xima dist√¢ncia&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 188.4203&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;min(dist(data@coords)) # minima dist√¢ncia entre pontos, ajuda a definir o tamanho do lag&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [1] 11.40175&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Variograma de n√∫vem
variograma &amp;lt;- gstat::variogram(COT ~ 1, data, cloud = TRUE, cutoff = Inf)
plot(variograma, ylab = &amp;quot;semivari√¢ncia&amp;quot;, xlab = &amp;quot;dist√¢ncia (m)&amp;quot;)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://eliasmcosta.netlify.app/post/geo/index_files/figure-html/lendo%20e%20plotando%20os%20dados-3.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Variograma experimental
v &amp;lt;- variogram(COT ~ 1, data, cutoff=90, width=7)
print(plot(v, plot.numbers=F))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://eliasmcosta.netlify.app/post/geo/index_files/figure-html/lendo%20e%20plotando%20os%20dados-4.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# width √© o tamanho do lag (passo), ou seja, um ponto m√©dio (uma simplifica√ß√£o) a cada 1800 m
# Cutoff = dist√¢ncia M√°xima de busca que a gente viu em 2/3 √© em torno de 70000 m, mas vimos que uma dist√¢ncia mais curta √© melhor ent√£o usamos 11000


####### Alguns exemplos de poss√≠veis modelos dispon√≠veis em R #####
print(show.vgms())&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://eliasmcosta.netlify.app/post/geo/index_files/figure-html/lendo%20e%20plotando%20os%20dados-5.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;### Modelo esf√©rico
vm1 &amp;lt;- vgm(psill=15, model=&amp;quot;Sph&amp;quot;,range=40,nugget=0)
print(plot(v, pl=F, model=vm1, main = &amp;quot;Esf√©rico&amp;quot;))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://eliasmcosta.netlify.app/post/geo/index_files/figure-html/lendo%20e%20plotando%20os%20dados-6.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;### Modelo Exponencial
vm2 &amp;lt;- vgm(psill=15, model=&amp;quot;Exp&amp;quot;,range=15,nugget=0)
print(plot(v, pl=F, model=vm2))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://eliasmcosta.netlify.app/post/geo/index_files/figure-html/lendo%20e%20plotando%20os%20dados-7.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;### Modelo Gaussiano
vm3 &amp;lt;- vgm(psill=16, model=&amp;quot;Gau&amp;quot;,range=20,nugget=0)
print(plot(v, pl=F, model=vm3))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://eliasmcosta.netlify.app/post/geo/index_files/figure-html/lendo%20e%20plotando%20os%20dados-8.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Modelo Ajustado esf√©rico
(vmf1 &amp;lt;- fit.variogram(v, vm1))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning in fit.variogram(v, vm1): No convergence after 200 iterations: try
## different initial values?&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   model    psill    range
## 1   Nug  0.00000  0.00000
## 2   Sph 14.66166 35.26004&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;print(plot(v, pl=F, model=vmf1))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://eliasmcosta.netlify.app/post/geo/index_files/figure-html/lendo%20e%20plotando%20os%20dados-9.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Modelo Ajustado Exponencial
(vmf2 &amp;lt;- fit.variogram(v, vm2))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   model    psill    range
## 1   Nug  0.00000  0.00000
## 2   Exp 15.34669 14.71238&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;print(plot(v, pl=F, model=vmf2))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://eliasmcosta.netlify.app/post/geo/index_files/figure-html/lendo%20e%20plotando%20os%20dados-10.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;# Modelo Gaussiano
(vmf3 &amp;lt;- fit.variogram(v, vm3))&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning in fit.variogram(object, model, fit.sills = fit.sills, fit.ranges =
## fit.ranges, : No convergence after 200 iterations: try different initial values?&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;##   model    psill    range
## 1   Nug  0.00000  0.00000
## 2   Gau 14.59874 16.27831&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;print(plot(v, pl=F, model=vmf3))&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://eliasmcosta.netlify.app/post/geo/index_files/figure-html/lendo%20e%20plotando%20os%20dados-11.png&#34; width=&#34;672&#34; /&gt;
# krigagem
Agora usamos a estrutura espacial para interpolar ‚Äúde forma otimizada‚Äù para os locais n√£o amostrados. Existem muitas maneiras de interpolar; vamos primeiro investigar a krigagem ordin√°ria.
O que h√° de t√£o especial na krigagem?
‚Ä¢ Prev√™ em qualquer ponto como a m√©dia ponderada dos valores em pontos n√£o amostrados
‚Ä¢ Os pesos dados a cada ponto da amostra s√£o √≥timos, dado a estrutura de covari√¢ncia, conforme revelado pelo modelo de variograma (neste sentido o que √© ‚Äúmelhor‚Äù se ajutou)
‚Ä¢ A varia√ß√£o de krigagem em cada ponto √© gerada automaticamente como parte do processo de c√°lculo dos pesos.&lt;/p&gt;
&lt;/div&gt;
&lt;div id=&#34;krigagem-ordin√°ria&#34; class=&#34;section level2&#34;&gt;
&lt;h2&gt;Krigagem ordin√°ria&lt;/h2&gt;
&lt;p&gt;Antes de fazer as predi√ß√µes nos grids para gera√ß√£o dos mapas vamos fazer as predi√ß√µes no conjunto de dados de valida√ß√£o para avaliar o desempenho dos modelos.&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;### Krigando no grid para gera√ß√£o do mapa
## Carregando o limite da √°rea no formato shapefile
limite &amp;lt;- maptools::readShapeSpatial(&amp;quot;/home/elias/MEGA/Geo/shape/limite.shp&amp;quot;, 
                                     proj4string=WGS23S, verbose=TRUE)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: readShapeSpatial is deprecated; use rgdal::readOGR or sf::st_read&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Shapefile type: PolygonZ, (15), # of Shapes: 1&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Warning: readShapePoly is deprecated; use rgdal::readOGR or sf::st_read&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## Shapefile type: PolygonZ, (15), # of Shapes: 1&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;### Predic√£o Exp
grid &amp;lt;- krige(COT ~ 1, locations=data, newdata=grid, model=vm3)&lt;/code&gt;&lt;/pre&gt;
&lt;pre&gt;&lt;code&gt;## [using ordinary kriging]&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;grid &amp;lt;- raster::stack(grid)
grid = raster::mask(grid, limite)
raster = raster::mask(raster, limite)

tm_shape(limite)+
  tm_polygons(col = &amp;quot;lightgrey&amp;quot;)+
  tm_shape(data) +
  tm_symbols(col = &amp;quot;COT&amp;quot;, palette = &amp;#39;YlOrRd&amp;#39;, size = &amp;quot;COT&amp;quot;, scale = 1.5,
             legend.size.show = F,    # comment this line to see the original size legend
             legend.col.show = T,     # comment this line to see the original color legend
             title.col=&amp;quot;AWC (mm)&amp;quot;) +
  tm_compass(position = c(&amp;quot;center&amp;quot;, &amp;quot;top&amp;quot;), size=4) +
  tm_grid(alpha = 0.2, labels.size = 1, labels.rot = c(0,90), n.x=5, n.y=6) + 
  tm_scale_bar(position = c(&amp;quot;right&amp;quot;, &amp;quot;bottom&amp;quot;), text.size =1) +
  tm_layout(title = &amp;quot;&amp;quot;, legend.position = c(&amp;quot;left&amp;quot;, &amp;quot;top&amp;quot;), main.title.position = &amp;#39;center&amp;#39;, legend.text.size = 1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://eliasmcosta.netlify.app/post/geo/index_files/figure-html/kriging-1.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tm_shape(grid$var1.pred) +
  tm_raster(title = &amp;quot;COT (g.kg-1)&amp;quot;, style = &amp;quot;cont&amp;quot;,  breaks = c(0,5,10,15,20,25))+
  tm_shape(limite)+
  tm_polygons(col = &amp;quot;black&amp;quot;, alpha = 0, border.col=&amp;quot;black&amp;quot;)+
  tm_compass(position = c(&amp;quot;right&amp;quot;, &amp;quot;top&amp;quot;), size=4) +
  tm_grid(alpha = 0.2, labels.size = 1, labels.rot = c(0,90), n.x=3, n.y=3) + 
  tm_scale_bar(position = c(&amp;quot;right&amp;quot;, &amp;quot;bottom&amp;quot;), text.size =1) +
  tm_layout(title = &amp;quot;&amp;quot;, legend.position = c(&amp;quot;left&amp;quot;, &amp;quot;top&amp;quot;), main.title.position = &amp;#39;center&amp;#39;, legend.text.size = 1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://eliasmcosta.netlify.app/post/geo/index_files/figure-html/kriging-2.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;pre class=&#34;r&#34;&gt;&lt;code&gt;tm_shape(raster) +
  tm_rgb(r=1, g=2, b=3)+
  tm_shape(limite)+
  tm_polygons(col = &amp;quot;black&amp;quot;, alpha = 0, border.col=&amp;quot;black&amp;quot;)+
  tm_compass(position = c(&amp;quot;right&amp;quot;, &amp;quot;top&amp;quot;), size=4) +
  tm_grid(alpha = 0.2, labels.size = 1, labels.rot = c(0,90), n.x=3, n.y=3) + 
  tm_scale_bar(position = c(&amp;quot;right&amp;quot;, &amp;quot;bottom&amp;quot;), text.size =1) +
  tm_layout(title = &amp;quot;&amp;quot;, legend.position = c(&amp;quot;left&amp;quot;, &amp;quot;top&amp;quot;), main.title.position = &amp;#39;center&amp;#39;, legend.text.size = 1)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&#34;https://eliasmcosta.netlify.app/post/geo/index_files/figure-html/kriging-3.png&#34; width=&#34;672&#34; /&gt;&lt;/p&gt;
&lt;div id=&#34;se-voc√™-chegou-at√©-aqui-muito-bem&#34; class=&#34;section level3&#34;&gt;
&lt;h3&gt;Se voc√™ chegou at√© aqui muito bem !!!! üëèüëèüëè&lt;/h3&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;div id=&#34;refer√™ncias&#34; class=&#34;section level1 unnumbered&#34;&gt;
&lt;h1&gt;Refer√™ncias&lt;/h1&gt;
&lt;div id=&#34;refs&#34; class=&#34;references csl-bib-body hanging-indent&#34;&gt;
&lt;div id=&#34;ref-Krige1951&#34; class=&#34;csl-entry&#34;&gt;
Krige, D.G., 1951. A statistical approach to some basic mine valuation problems on the witwatersand. Journal of the Chemical, Metallurgical and Mining Society of South Africa 52, 119‚Äì139.
&lt;/div&gt;
&lt;div id=&#34;ref-Matheron1971&#34; class=&#34;csl-entry&#34;&gt;
Matheron, G., 1971. The theory of regionalized variables and its applications. Les Cahiers du Centre de Morphologie Mathematique in Fontainebleu, Paris 211.
&lt;/div&gt;
&lt;div id=&#34;ref-Matheron1963&#34; class=&#34;csl-entry&#34;&gt;
Matheron, G., 1963. Principles of geostatistics. Economic Geology 58, 1246‚Äì1266.
&lt;/div&gt;
&lt;/div&gt;
&lt;/div&gt;
</description>
    </item>
    
  </channel>
</rss>
