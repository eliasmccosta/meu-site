---
date: "2020-05-15"
diagram: true
image:
  caption: 'Image credit: [**Elias**](https://www.instagram.com/eliasmendescosta/)'
  focal_point: ""
  placement: 3
math: true
title: Amostragem para mapeamento de solos
subtitle: 'Amostragem para mapeamento digital de solos: Um tutorial em R'
summary: ''
bibliography: [references.bib]
link-citations: true 
csl: [geoderma-regional.csl]
authors:
- admin
categories:
  - R
  - Programa√ß√£o
tags:
  - MDS
  - Amostragem
nocite: | 
  @R-bookdown
markup:
  goldmark:
    renderer:
      unsafe: true
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>


<div id="introdu√ß√£o" class="section level1">
<h1>Introdu√ß√£o</h1>
<div id="conceitos-b√°sicos-e-terminologias" class="section level2">
<h2>Conceitos b√°sicos e terminologias</h2>
<p>A <em>amostragem</em> diz respeito √† sele√ß√£o de um subconjunto de indiv√≠duos de uma popula√ß√£o para estimar caracter√≠sticas de toda a popula√ß√£o <span class="citation">(<a href="#ref-Wang2012a" role="doc-biblioref">Wang et al., 2012</a>)</span>. Ou a amostragem pode ser definida como sele√ß√£o de partes de um universo finito, com a proposta de obter informa√ß√µes desse universo <span class="citation">(<a href="#ref-deGruijter2006" role="doc-biblioref">Gruijter et al., 2006</a>)</span>. A <em>amostra</em> pode ser definida como a parte coletada, e levada para laborat√≥rio, ou observada <em>in situ</em>. E uma √∫nica parte dessa amostra pode ser definida como <em>unidade amostral</em>, o n√∫mero de unidades amostrais √© definido como <em>tamanho amostral</em> ou <em>n amostral</em> <span class="citation">(<a href="#ref-deGruijter2006" role="doc-biblioref">Gruijter et al., 2006</a>)</span>.
Uma confus√£o comum na literatura √© sobre a defini√ß√£o de amostragem aleat√≥ria e amostragem arbitr√°ria ou casual <span class="citation">(<a href="#ref-Brus2019" role="doc-biblioref">Brus, 2019</a>)</span> no segundo caso os locais de amostragem s√£o escolhidos, fundamentalmente, em fun√ß√£o da subjetividade da pessoa conduzindo o trabalho. Para evitar a confus√£o o termo <em>amostragem probabil√≠stica</em> deve ser priorizado para as amostras aleat√≥rias. A amostragem de probabil√≠stica √© uma amostragem aleat√≥ria que atende a dois requisitos. Em primeiro lugar, todas as unidades da popula√ß√£o t√™m uma probabilidade positiva de serem selecionadas. Nenhuma parte da popula√ß√£o pode ser exclu√≠da. Em segundo lugar, a probabilidade de sele√ß√£o de cada amostra poss√≠vel √© conhecida. Com amostragem arbitr√°ria (casual), esses dois requisitos geralmente n√£o s√£o atendidos <span class="citation">(<a href="#ref-Brus2019" role="doc-biblioref">Brus, 2019</a>)</span>.</p>
</div>
<div id="amostragem-no-mapeamento-convencional-de-solos" class="section level2">
<h2>Amostragem no mapeamento convencional de solos</h2>
<p>No caso do mapeamento convencional de solos, o m√©todo de prospe√ß√£o e a frequ√™ncia de amostragem dependem do n√≠vel de detalhe e do objetivo do levantamento <span class="citation">(<a href="#ref-IBGE2015" role="doc-biblioref">IBGE, 2015</a>)</span>. Por exemplo, na terceira edi√ß√£o do Manual T√©cnico de Pedologia <span class="citation">(<a href="#ref-IBGE2015" role="doc-biblioref">IBGE, 2015</a>)</span> o m√©todo de prospe√ß√£o indicado para levantamento explorat√≥rio √© o de extrapola√ß√£o, generaliza√ß√µes, correla√ß√µes e poucas observa√ß√µes de campo, com uma frequ√™ncia de amostragem de um perfil completo por classe de solo predominante na associa√ß√£o. Para o levantamento semi-detalhado a densidade de observa√ß√µes e a frequ√™ncia de amostragem s√£o calculadas em fun√ß√£o da heterogeneidade da √°rea e da facilidade de correla√ß√£o de solos e a superf√≠cie geomorfol√≥gicas. No entanto, √© recomendada uma m√©dia de 0,002 a 0,20 observa√ß√µes por hectare e um perfil completo e um complementar por classe de solo componente da unidade de mapeamento simples ou associa√ß√£o.
Por√©m para o mapeamento digital de solos (MDS) esse esquema de amostragem n√£o se aplica, pois n√£o fornece estimativa estat√≠stica representativa. No MDS √© necess√°rio o uso de estrat√©gias de amostragem estatisticamente robustas para diminuir a subjetividade e consequentemente os poss√≠veis erros na predi√ß√£o <span class="citation">(<a href="#ref-Minasny2007b" role="doc-biblioref">Minasny and McBratney, 2007</a>)</span></p>
</div>
<div id="amostragem-no-mapeamento-digital-de-solosmds" class="section level2">
<h2>Amostragem no mapeamento digital de solos(MDS)</h2>
<p>No caso do MDS a amostragem √© um fator crucial, pois pode contribuir para elevar ou diminuir os custos do levantamento de solos. E √© considera uma das etapas mais importantes para o MDS <span class="citation">(<a href="#ref-CarvalhoJunior2014" role="doc-biblioref">Carvalho J√∫nior et al., 2014</a>)</span>. Normalmente no MDS, as amostras de calibra√ß√£o de modelos (geo)estat√≠sticos as amostras coletadas devem representar ao m√°ximo a distribui√ß√£o espacial do que est√° sendo modelado (atributo ou classe de solo), por isso t√©cnicas como o Hipercubo Latino Condicionado (cLHS) <span class="citation">(<a href="#ref-Minasny2006" role="doc-biblioref">Minasny and McBratney, 2006</a>)</span> s√£o frequentemente usados nessa etapa e para essa finalidade. Esse tipo de amostragem √© conhecido como amostragem n√£o probabil√≠stica e ser√° abordado com mais detalhes nos exemplos.
Para valida√ß√£o dos resultados das predi√ß√µes espaciais no MDS o tipo de abordagem recomendado √© a amostragem probabil√≠stica <span class="citation">(<a href="#ref-BrusEtAl2011" role="doc-biblioref">Brus et al., 2011</a>)</span>, esse tipo de amostragem busca a imparcialidade e diminui√ß√£o de vi√©s para valida√ß√£o dos produtos do mapeamento. Aten√ß√£o especial deve ser tomada nessa etapa, pois nem sempre √© poss√≠vel uma amostragem completamente probabil√≠stica (aleat√≥ria). H√° ent√£o a necessidade de encontrar a condi√ß√£o perfeita do que √© fact√≠vel e o ideal. Exemplos de amostragem probabil√≠stica ser√£o abordados com mais detalhe nos exemplos.<br />
Parte do material aqui desenvolvido foi extra√≠do e adaptado do livro em desenvolvimento de Alessandro Samuel-Rosa, <a href="http://samuel-rosa.github.io/pedometria-feita-simples/principios-da-amostragem-espacial.html">pedometria feita simples</a>. O cap√≠tulo 7 do livro trata de princ√≠pios da amostragem espacial. Tamb√©m foram extra√≠das informa√ß√µes a respeito de amostragem para valida√ß√£o de mapas digitais de solos <span class="citation">(<a href="#ref-BrusEtAl2011" role="doc-biblioref">Brus et al., 2011</a>)</span> e amostragem para mapeamento de solos <span class="citation">(<a href="#ref-Brus2019" role="doc-biblioref">Brus, 2019</a>)</span>. Assim objetivo desse tutorial e compilar as informa√ß√µes dos trabalhos mencionados para simular diferentes estrat√©gias amostrais e dar suporte aos levantamentos de solos com foco em MDS e na agricultura de precis√£o (AP) e avalia√ß√£o dos produtos gerados.</p>
</div>
</div>
<div id="√°rea-experimental-e-base-dados" class="section level1">
<h1>√Årea experimental e base dados</h1>
<div id="√°rea-experimental" class="section level2">
<h2>√Årea experimental</h2>
Ao longo desse tutorial sobre amostragem, voc√™ ver√° exemplos de cada tipo de amostragem implementados no R usando o conjunto de dados de um √°rea experimental localizada no munic√≠pio de Serop√©dica, estado do Rio de Janeiro, Brasil, nas coordenadas geogr√°ficas centrais aproximadas 22¬∫54‚Äô00‚Äù S e 43¬∫55‚Äô00‚Äù W (Figura <a href="#fig:localizacao1">1</a>).
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:localizacao1"></span>
<img src="localizacao1.png" alt="Mapa de localiza√ß√£o do munic√≠pio de Serop√©dica-RJ. Fonte: Nascimento (2019)" width="296" />
<p class="caption">
Figure 1: Mapa de localiza√ß√£o do munic√≠pio de Serop√©dica-RJ. Fonte: Nascimento (2019)
</p>
</div>
Especificamente, o trabalho foi desenvolvido na Fazendinha Agroecol√≥gica km 47 (Sistema Integrado de Produ√ß√£o Agroecol√≥gica - SIPA), associada √† Embrapa Agrobiologia, Empresa de Pesquisa Agropecu√°ria do Estado do Rio de Janeiro (Pesagro-Rio) e Universidade Federal Rural do Rio de Janeiro, nas coordenadas geogr√°ficas centrais aproximadas 22¬∫45‚Äô0‚Äù S e 43¬∫40‚Äô30‚Äù W (Figura <a href="#fig:localizacao2">2</a>).
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:localizacao2"></span>
<img src="localizacao2.png" alt="Mapa de localiza√ß√£o da √°rea de estudo em Serop√©dica-RJ. Fonte: Nascimento (2019)" width="267" />
<p class="caption">
Figure 2: Mapa de localiza√ß√£o da √°rea de estudo em Serop√©dica-RJ. Fonte: Nascimento (2019)
</p>
</div>
<p>O clima do munic√≠pio caracteriza-se por ser do tipo Aw (Tropical com inverno seco), segundo a classifica√ß√£o de K√∂ppen. Serop√©dica tem uma temperatura m√©dia de 23,5 ¬∞C e uma pluviosidade m√©dia anual de 1354 mm. Os maiores valores de precipita√ß√£o s√£o verificados nos meses de novembro a janeiro e os menores no per√≠odo entre maio e agosto <span class="citation">(<a href="#ref-Oliveira-J2014" role="doc-biblioref">Oliveira-J√∫nior et al., 2014</a>)</span>. A √°rea dos exemplos encontra-se ocupada por pastagem e caracteriza-se por apresentar relevo suave-ondulado a ondulado, altitude entre 17 a 50 m sobre o n√≠vel do mar, e aus√™ncia de rochosidade e pedregosidade em superf√≠cie <span class="citation">(<a href="#ref-Nascimento2019" role="doc-biblioref">Nascimento, 2019</a>)</span>.</p>
<p>Os solos da √°rea experimental s√£o caraterizados por apresentar, no geral, baixa fertilidade e elevado grau de desenvolvimento com fatores e processos de forma√ß√£o espec√≠ficos e dominantes para cada ordem e posi√ß√£o da paisagem. Para o trabalho de onde os dados derivam <span class="citation">(<a href="#ref-Nascimento2019" role="doc-biblioref">Nascimento, 2019</a>)</span>, foram abertas 10 trincheiras em diferentes pontos da paisagem, onde foram descritos, coletados e classificados perfis de solo, sendo uma trincheira no topo (P10), duas na posi√ß√£o de ter√ßo m√©dio (P3 e P9), uma no ter√ßo inferior (P8), tr√™s no sop√© da vertente (P2, P5 e P7) e tr√™s na √°rea de baixada (P1, P4 e P6). Os solos foram classificados respectivamente como Argissolos Vermelhos P10, P9 e P3; Argissolo Amarelo, P8; Planossolos H√°plicos (ar√™nicos e espessarenicos), P7,P2,P5; Planossolos H√°plicos (gleiss√≥licos), P4, P6 e Cambissolo H√°lico (com evidente processos de gleiza√ß√£o) P1 (Figura <a href="#fig:localizacao2">2</a>).</p>
</div>
<div id="base-de-dados-covari√°veis-ambientais" class="section level2">
<h2>Base de dados (Covari√°veis ambientais)</h2>
<p>As covari√°veis ambientais para modelar as propriedades do solo foram derivadas de duas fontes de dados: modelo digital de eleva√ß√£o, dados de sensoriamento remoto (imagem orbital-RadipEye). Essas foram escolhidas para descrever os principais fatores de forma√ß√£o do solo, de acordo com a abordagem <em>scorpan</em> <span class="citation">(<a href="#ref-McBratneyEtAl2003" role="doc-biblioref">McBratney et al., 2003</a>)</span>.</p>
<p><em>Modelo Digital de Eleva√ß√£o (MDE)</em>: O MDE utilizado, com resolu√ß√£o espacial de 2 m, foi gerado a partir das curvas de n√≠vel e pontos cotados coletados com gps geod√©sico. Do MDE foram derivados 12 atributos de terreno com potencial de uso para modelagem no MDS.</p>
<p><em>Imagem de sat√©lite</em>: foram utilizadas duas cenas do sensor RapidEye ambas de 2011. As duas cenas foram usadas para cobrir toda a √°rea de estudo, essas imagens t√™m resolu√ß√£o radiom√©trica de 12 bits, resolu√ß√£o espacial de 6,5 m, que ortorretificadas t√™m 5m <span class="citation">(<a href="#ref-RapidEye2012" role="doc-biblioref">RapidEye, 2012</a>)</span>.
Das cenas foram derivados os √≠ndices de vegeta√ß√£o (NDVI, ingl√™s) e √≠ndice de vegeta√ß√£o ajustado ao solo (SAVI, ingl√™s).</p>
</div>
<div id="√°reas-ambientalmente-homog√™neas-estratos" class="section level2">
<h2>√Åreas ambientalmente homog√™neas (Estratos)</h2>
<p>Para fazer o exerc√≠cio foram criadas √°reas ambientalmente similares (homog√™neas), essa abordagem √© indicada em casos onde h√° por exemplo o interesse de fazer a amostragem por estratos. Nesse exerc√≠cio optou-se por criar 10 estratos usando as vari√°veis, que julgamos serem as mais representativas para discretizar os ambientes. Foram elas eleva√ß√£o, declividade e SAVI. Para fazer o agrupamento da √°reas de maior similaridade (cria√ß√£o de clusters) foi utilizado o algor√≠timo de classifica√ß√£o n√£o supervisionada <em>K-Means Clustering</em> que visa particionar os pontos em k grupos de forma que a soma dos quadrados dos pontos aos centros de cluster designados seja minimizada. No m√≠nimo, todos os centros do cluster est√£o na m√©dia dos seus conjuntos de Voronoi (o conjunto de pontos de dados que est√£o mais pr√≥ximos do centro do cluster).</p>
</div>
<div id="voc√™-pode-baixar-os-dados-usados-aqui-no-seguinte-link" class="section level2">
<h2>Voc√™ pode baixar os dados usados aqui no seguinte link</h2>
<p>Para baixar shapes <a href="https://mega.nz/folder/2FYmnSTZ#U8KUUKsOV5DzaBK5oQXEzA">shape</a> e para baixar os dados <a href="https://mega.nz/folder/PMIi1IzT#OqptGkjIKxJigwPFGPB47g">data</a></p>
<pre class="r"><code>## Carregar os pacotes
library(sp)
library(raster)
library(sampling)
library(maptools)
library(rgdal)
library(clhs)
library(spsann)
library(sf)
# Carregando a base de dados da fazendinha
# Aqui voc√™ precisa direcionar o diret√≥rio onde salvou os dados no seu computador
dados &lt;- read.csv(&quot;/home/elias/MEGA/Fazendinha/data/dataset.csv&quot;); dados=dados[2:54]
grid &lt;- read.csv(&quot;/home/elias/MEGA/Fazendinha/data/grid.csv&quot;); grid=grid[2:23]

# criando um cluster de unidades homog√™neas usando os dados das covari√°veis ambientais
cluster &lt;- kmeans(grid[, c(1,2,20)], 10)
cluster = data.frame(cluster$cluster)
grid=cbind(grid,cluster)

## Foi necess√°rio transformar os estratos para fator 
##porque estava dando erro quando calculava o n√∫mero
## de amostras por estrato 

# Fun√ß√£o para transformar uma vari√°vel em fator
grid$cluster.cluster=as.factor(grid$cluster.cluster) 
grid1=grid
#cluster=data.frame(grid[,c(&quot;X&quot;,&quot;Y&quot;)],results=cluster$cluster)
#coordinates(cluster)= ~ X+Y; gridded(cluster)=T; cluster=raster(cluster)
#plot(cluster)

# Transformar o dataframe do grid em spatialdataframe
sp::gridded(grid) &lt;- ~ X + Y
sp::proj4string(grid) &lt;- sp::CRS(&quot;+proj=utm +zone=23 +south +ellps=GRS80 +
                                 towgs84=0,0,0,0,0,0,0 +units=m +no_defs&quot;) 

# Definindo o sistema de proj√ß√£o
crsSIRGAS2000=CRS(&quot;+proj=utm +zone=23 +south +ellps=GRS80 +
                  towgs84=0,0,0,0,0,0,0 +units=m +no_defs&quot;) 

#carregando arquivos shapfile
# Aqui voc√™ precisa direcionar o diret√≥rio onde salvou os dados no seu computador
## Estradas
estrada &lt;- maptools::readShapeSpatial(&quot;/home/elias/MEGA/Fazendinha/shape/estrada.shp&quot;, 
                                         proj4string=crsSIRGAS2000,verbose=TRUE)</code></pre>
<pre><code>## Shapefile type: PolyLine, (3), # of Shapes: 1
## Shapefile type: PolyLine, (3), # of Shapes: 1</code></pre>
<pre class="r"><code>## Perfis completos
perfis &lt;- maptools::readShapeSpatial(&quot;/home/elias/MEGA/Fazendinha/shape/pontos.shp&quot;, 
                                      proj4string=crsSIRGAS2000,verbose=TRUE)</code></pre>
<pre><code>## Shapefile type: Point, (1), # of Shapes: 71
## Shapefile type: Point, (1), # of Shapes: 71</code></pre>
</div>
</div>
<div id="amostragem-para-mapeamento-de-solos" class="section level1">
<h1>Amostragem para mapeamento de solos</h1>
<p>N√£o existe um √∫nico tipo de estrat√©gia amostral para qualquer trabalho de MDS ou AP, cada caso precisa ser estudado de forma particular e no geral a melhor estrat√©gia depende do objetivo do projeto, do recurso financeiro e humano dispon√≠vel e dificuldades operacionais encontradas na √°rea que est√° sendo estuda. Do ponto de vista de dificuldades operacionais tem-se alguns variantes como limita√ß√£o de acesso, por se tratar de √°reas com acesso limitado, nesses casos h√° abordagens de amostragem espec√≠fica como mostra <span class="citation"><a href="#ref-CambuleEtAl2013" role="doc-biblioref">Cambule et al.</a> (<a href="#ref-CambuleEtAl2013" role="doc-biblioref">2013</a>)</span> onde se tem √°reas de maior acessibilidade e que sejam representativas da √°rea total de estudo. Ainda pode haver limita√ß√£o por permiss√£o de acesso, sobretudo em √°reas particulares. Quanto aos tipos de amostragem elas s√£o divididas basicamente em dois grupos ou tipos fundamentais: <em>Amostragem probabil√≠stica</em> e <em>n√£o probabil√≠stica</em></p>
<div id="amostragem-n√£o-probabil√≠stica" class="section level2">
<h2>Amostragem n√£o probabil√≠stica</h2>
<p>A amostragem n√£o probabil√≠stica √© uma t√©cnica de amostragem em que as amostras s√£o reunidas em um processo que n√£o d√° a todos os indiv√≠duos, no caso de solos perfil de solo <em>pedon</em> ou ponto amostral da popula√ß√£o, chances iguais de serem selecionados. A escolha dos locais de amostragem depende da defini√ß√£o de um crit√©rio a ser atendido, normalmente em MDS a caracteriza√ß√£o da m√°xima varia√ß√£o de solos e suas propriedades representadas pelas covari√°veis ambientais que simulam os fatores de forma√ß√£o do solo <span class="citation">(<a href="#ref-McBratneyEtAl2003" role="doc-biblioref">McBratney et al., 2003</a>)</span>.
A amostragem n√£o-probabil√≠stica costuma ser dividida em tr√™s categorias:</p>
<p><em>casual,
</em>conveniente, e
*intencional</p>
<p>Al√©m disso h√° amostragens n√£o probabil√≠sticas, onde atrav√©s de algoritmos e de acordo com uma determinada finalidade, pode ser feita a otimiza√ß√£o da configura√ß√£o amostral. As principias otimiza√ß√µes s√£o para representar o m√°ximo poss√≠vel o espa√ßo de atributos (ex: tipos e/ou propriedades do solo) e espa√ßo geogr√°fico.</p>
<div id="amostragem-casual" class="section level3">
<h3>Amostragem casual</h3>
<p>Na amostragem casual os locais de amostragem s√£o escolhidos, fundamentalmente, em fun√ß√£o da subjetividade da pessoa conduzindo a amostragem. N√£o existe um crit√©rio claro a ser atendido. Outros locais amostrais podem ser escolhidos caso outra pessoa conduza a amostragem, mesmo que n√£o haja justificativa plaus√≠vel para isso. Para fim de MDS e aplica√ß√µs de AP esse tipo de amostragem n√£o √© recomendado e √© mais comum em trabalhos de convencionais de an√°lise de fertilidade do solo.
Na pr√°tica, a amostragem casual consiste em transitar pela √°rea a ser amostrada e, aqui e acol√° (ex: Zig-Zag), definir um local para amostragem. No caso da amostra para fins de avalia√ß√£o da fertilidade do solo normalmente √© feito uma divis√£o da √°rea em glebas (√°reas menores, mais homog√™neas). Essa divis√£o deve considerar a inclina√ß√£o do terreno, o tipo de cultura, a idade da cultura, as aduba√ß√µes feitas anteriormente e etc. Esse tipo de amostragem d√° a impress√£o de que as observa√ß√µes s√£o aleat√≥rias, um pressuposto estat√≠stico comum, mas como elas foram escolhidas subjetivamente pela pessoa que est√° conduzindo o trabalho n√£o √© poss√≠vel se calcular a probabilidade de inclus√£o de cada amostra, portanto ela √© casual, mas n√£o aleat√≥ria.</p>
<pre class="r"><code>main &lt;- &quot;Amostra casual (zig-zag)&quot;
plot(
  grid@coords, type = &quot;n&quot;, asp = 1, main = main,
  xlab = &quot;Longitude (m)&quot;, ylab = &quot;Latitude (m)&quot;)
image(
  grid, &quot;cluster.cluster&quot;, col = terrain.colors(10), axes = TRUE, add = TRUE)
legend(
  &quot;topleft&quot;, title = &quot;√Åreas homog√™neas&quot;, fill = terrain.colors(3),
  legend = c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;),
  border = terrain.colors(10), bty = &quot;n&quot;)
set.seed(2000)
pts &lt;- sp::spsample(grid, n = 30, type = &quot;nonaligned&quot;)
points(pts, pch = 21, cex = 0.75)
arrows(
  grid@coords[1, 1], grid@coords[1, 2], pts@coords[length(pts), 1],
  pts@coords[length(pts), 2],  length = 0.1)
for (i in 2:length(pts) - 1) {
  arrows(
    x1 = pts@coords[i, 1], y1 = pts@coords[i, 2], x0 = pts@coords[i + 1, 1], 
    y0 = pts@coords[i + 1, 2],  length = 0.1)
}
leg &lt;- paste(&quot;Amostras (n = &quot;, length(pts), &quot;)&quot;, sep = &quot;&quot;)
legend(635700, 7483400, legend = leg, pch = 21, bty = &quot;n&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
</div>
<div id="amostragem-conveniente" class="section level3">
<h3>Amostragem conveniente</h3>
<p>Esse √© um dos exemplos de amostragem em que o processo n√£o √© completamente aleat√≥rio, pois s√£o priorizados por exemplo locais ao longo das estradas, num tipo de amostragem que pode ser aleat√≥rio (dentro do limite de acessibilidade, que seja conveniente) ou amostragem arbitr√°ria, ou seja, amostragem sem uma finalidade espec√≠fica em mente, a amostragem pode ser ainda direcionada em que o usu√°rio decide os locais que ser√£o amostrados.
Esse tipo de amostragem busca otimizar recursos (financeiros e operacionais) evitando locais de dif√≠cil acesso, podendo assim realizar um n√∫mero maior de observa√ß√µes. Como resultado esse tipo de amostragem tem observa√ß√µes concentradas por exemplo em √°reas pr√≥ximo a estradas e/ou trilhas, em √°reas n√£o montanhosas, em bordas, quando em condi√ß√£o de densas florestas.
Aqui foram selecionadas amostras com dist√¢ncia m√°xima da estrada de 50 m</p>
<pre class="r"><code>main &lt;- &quot;Amostra conveninte (distante da margem da estrada)&quot;
plot(
  grid@coords, type = &quot;n&quot;, asp = 1, main = main,
  xlab = &quot;Longitude (m)&quot;, ylab = &quot;Latitude (m)&quot;)
image(
  grid, &quot;cluster.cluster&quot;, col = terrain.colors(10), axes = TRUE, add = TRUE)
legend(
  &quot;topleft&quot;, title = &quot;Tipo de solo&quot;, fill = terrain.colors(10),
  legend = c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;),
  border = terrain.colors(10), bty = &quot;n&quot;)
plot(estrada, add=TRUE)
t=buffer(estrada, width=50)
r &lt;- raster(grid) 
lr &lt;- mask(r, t)
lr=as(lr, &quot;SpatialPixelsDataFrame&quot;)
points(spsample(lr, n = 30, &quot;random&quot;), pch = 21, cex = 0.75)
leg &lt;- paste(&quot;Amostras (n = &quot;, length(pts), &quot;)&quot;, sep = &quot;&quot;)
legend(635700, 7483400, legend = leg, pch = 21, bty = &quot;n&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-4-1.png" width="672" /></p>
</div>
<div id="amostragem-intencional" class="section level3">
<h3>Amostragem intencional</h3>
<p>Semelhante a amostragem convencional a amostragem intencional tamb√©m busca otimizar recursos financeiros e operacionais, mas difere principalmente porque na amostragem intencional s√£o agregados algum tipo de crit√©rio, por exemplo o pedol√≥gico, ou algum que atenda uma demnada espec√≠fica em levantamento para fins de fertilidade do solo e/ou algum crit√©rio estat√≠stico.
Em geral, a amostragem intencional √© o tipo de amostragem mais eficiente para a obten√ß√£o de observa√ß√µes de calibra√ß√£o para a modelagem espacial do solo. Isso se d√° exatamente porque a localiza√ß√£o das observa√ß√µes √© definida com base no modelo usado para descrever a estrutura da varia√ß√£o espacial do solo bem como capturar as varia√ß√µes dos fatores envolvidos com g√™nese do solo <span class="citation">(<a href="#ref-McBratneyEtAl2003" role="doc-biblioref">McBratney et al., 2003</a>)</span>. Em outras palavras, a configura√ß√£o espacial das observa√ß√µes √© otimizada para atender aos pressupostos e requerimentos do modelo forma√ß√£o do solo (<em>SCORPAN</em>) que ser√° usado na modelagem. Quanto melhor as amostras representarem as rela√ß√µes solo-paisagem e estrutura espacial dos dados, melhor ser√° o desempenho do modelo calibrado.</p>
<div id="amostragem-intencional-sistem√°tica" class="section level4">
<h4>Amostragem intencional sistem√°tica</h4>
<p>Na amostragem intencional sistem√°tica usa algum crit√©rio pedol√≥gico e/ou estat√≠stico e tem origem no modelo usado para descrever a estrutura da varia√ß√£o espacial do solo ou no m√©todo usado para fazer predi√ß√µes espaciais. Por exemplo, o objetivo pode ser selecionar os locais amostrais de maneira a obter a melhor cobertura espacial porque isso pode minimizar a incerteza ou erros das predi√ß√µes. O resultado dessa amostragem √© a aloca√ß√£o de observa√ß√µes equidistantes no que √© denominado <em>malha</em> ou <em>grid</em>, que pode ser quadrada ou triangular.
Esse tipo de amostragem √© comumente usado em trabalhos de mapeamento do solo para fins de AP, por exemplo para avalia√ß√£o da fertilidade do solo, pois essas √°reas s√£o normalmente homog√™neas e de mais f√°cil acesso.</p>
<pre class="r"><code>main &lt;- &quot;Amostra sistem√°tica (malha quadrada)&quot;
plot(
  grid@coords, type = &quot;n&quot;, asp = 1, main = main,
  xlab = &quot;Longitude (m)&quot;, ylab = &quot;Latitude (m)&quot;)
image(
  grid, &quot;cluster.cluster&quot;, col = terrain.colors(10), axes = TRUE, add = TRUE)
legend(
  &quot;topleft&quot;, title = &quot;√Åreas homog√™neas&quot;, fill = terrain.colors(10),
  legend = c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;),
  border = terrain.colors(10), bty = &quot;n&quot;)
pts &lt;- sp::spsample(grid, n = 30, type = &quot;regular&quot;, offset = c(0.5, 0.5))
points(pts, pch = 21, cex = 0.75)
polygon(pts@coords[c(1, 2, 6, 5, 1), ])
leg &lt;- paste(&quot;Amostras (n = &quot;, length(pts), &quot;)&quot;, sep = &quot;&quot;)
legend(635700, 7483400, legend = leg, pch = 21, bty = &quot;n&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
<pre class="r"><code>main &lt;- &quot;Amostra sistem√°tica (malha triangular)&quot;
plot(
  grid@coords, type = &quot;n&quot;, asp = 1, main = main,
  xlab = &quot;Longitude (m)&quot;, ylab = &quot;Latitude (m)&quot;)
image(
  grid, &quot;cluster.cluster&quot;, col = terrain.colors(10), axes = TRUE, add = TRUE)
legend(
  &quot;topleft&quot;, title = &quot;√Åreas homog√™neas&quot;, fill = terrain.colors(10),
  legend = c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;),
  border = terrain.colors(10), bty = &quot;n&quot;)
pts &lt;- sp::spsample(grid, n = 34, type = &quot;hexagonal&quot;, offset = c(0.5, 0.5))
points(pts, pch = 21, cex = 0.75)
polygon(pts@coords[c(1, 2, 5, 1), ])
leg &lt;- paste(&quot;Amostras (n = &quot;, length(pts), &quot;)&quot;, sep = &quot;&quot;)
legend(635700, 7483400, legend = leg, pch = 21, bty = &quot;n&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-5-2.png" width="672" /></p>
</div>
<div id="amostragem-intencional-caminhamento-livre" class="section level4">
<h4>Amostragem intencional caminhamento livre</h4>
<p>No crit√©rio intencional denominado caminhamento livre, as amostras s√£o escolhidas a fim de agregar as quest√µes de custos, conhecimento do especialista (ex: Ped√≥logo), e m√°xima caracteriza√ß√£o da √°rea. A localiza√ß√£o das observa√ß√µes √© definida com base no conhecimento t√°cito do respons√°vel, no seu modelo mental das rela√ß√µes solo-paisagem ou na pedog√™nese. O modelo mental √© constru√≠do com a experi√™ncia obtida no campo e sua qualidade geralmente √© diretamente proporcional ao n√∫mero de anos de trabalho de campo e a diversidade de solos e paisagem que o profissional pode visitar.
Alguns dos exemplos s√£o amostragens em <em>Topossequ√™ncia</em>, que busca amostrar os diferentes tipos de solos de acordo com sua varia√ß√£o topogr√°fica, <em>Topolitossequ√™ncia</em>, que √© a varia√ß√£o no relevo e material de origem, <em>Climosequ√™ncia</em>, que caracteriza varia√ß√£o nas condi√ß√µes clim√°ticas da regi√£o de estudo.</p>
<pre class="r"><code>main &lt;- &quot;Caminhamento livre&quot;
plot(
  grid@coords, type = &quot;n&quot;, asp = 1, main = main,
  xlab = &quot;Longitude (m)&quot;, ylab = &quot;Latitude (m)&quot;)
image(
  grid, &quot;cluster.cluster&quot;, col = terrain.colors(10), axes = TRUE, add = TRUE)
legend(
  &quot;topleft&quot;, title = &quot;√Åreas homog√™neas&quot;, fill = terrain.colors(3),
  legend = c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;),
  border = terrain.colors(10), bty = &quot;n&quot;)
points(perfis, pch = 21, cex = 0.75)
text(perfis, perfis$id, cex=0.75, adj = c(01.5))
arrows(
  grid@coords[1, 1], grid@coords[1, 2], perfis@coords[length(perfis), 1], 
  perfis@coords[length(perfis), 2],
  length = 0.1)
for (i in 2:length(perfis) - 1) {
  arrows(
    x1 = perfis@coords[i, 1], y1 = perfis@coords[i, 2], x0 = perfis@coords[i + 1, 1], 
    y0 = perfis@coords[i + 1, 2], length = 0.1)
}
leg &lt;- paste(&quot;Amostras n = 10&quot;, sep = &quot;&quot;)
legend(635700, 7483400, legend = leg, pch = 21, bty = &quot;n&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
</div>
</div>
<div id="otimiza√ß√£o-de-configura√ß√µes-amostrais" class="section level3">
<h3>Otimiza√ß√£o de Configura√ß√µes Amostrais</h3>
<div id="hipercubo-latino-condicionado-clhs" class="section level4">
<h4>Hipercubo Latino Condicionado (cLHS)</h4>
<p>O cLHS √© um algoritmo de busca baseado em regras heur√≠sticas combinadas com um cronograma de recozimento simulado. Para amostragem de uma √°rea informa√ß√µes pr√©vias representativas da √°rea de estudo s√£o fornecidas ao algoritmo como dados auxiliares (covari√°veis ambientais). Ele fornece uma cobertura completa da faixa de cada covari√°vel estratificando a distribui√ß√£o marginal, ou seja, usa as informa√ß√µes fornecidas para produzir uma estratifica√ß√£o de amostragem otimizada <span class="citation">(<a href="#ref-Minasny2006" role="doc-biblioref">Minasny and McBratney, 2006</a>)</span>. Varia√ß√µes do cLHS para otimiza√ß√£o de locais de amostragem podem ser encontradas em <span class="citation"><a href="#ref-Roudier2012" role="doc-biblioref">Roudier et al.</a> (<a href="#ref-Roudier2012" role="doc-biblioref">2012</a>)</span>, <span class="citation"><a href="#ref-Mulder2013" role="doc-biblioref">Mulder et al.</a> (<a href="#ref-Mulder2013" role="doc-biblioref">2013</a>)</span>, <span class="citation"><a href="#ref-CarvalhoJunior2014" role="doc-biblioref">Carvalho J√∫nior et al.</a> (<a href="#ref-CarvalhoJunior2014" role="doc-biblioref">2014</a>)</span>, <span class="citation"><a href="#ref-Clifford2014" role="doc-biblioref">Clifford et al.</a> (<a href="#ref-Clifford2014" role="doc-biblioref">2014</a>)</span>, <span class="citation"><a href="#ref-Kidd2014" role="doc-biblioref">Kidd et al.</a> (<a href="#ref-Kidd2014" role="doc-biblioref">2015</a>)</span>, e <span class="citation"><a href="#ref-Stumpf2016" role="doc-biblioref">Stumpf et al.</a> (<a href="#ref-Stumpf2016" role="doc-biblioref">2016</a>)</span>.
No caso desse exemplo foi usado como vari√°veis auxiliares no cLHS a eleva√ß√£o, declividade e SAVI, ou seja, as mesmas que foram escolhidas para gerar as √°reas ambientalmente homog√™neas (os estratos) que foram tidas como as principais nesse estudo de caso.</p>
<pre class="r"><code>dem=raster(grid[1])
slope=raster(grid[2])
savi=raster(grid[20])
stack=raster::addLayer(dem, slope, savi)
s &lt;- rasterToPoints(stack, spatial=TRUE)
set.seed(2001)
pts &lt;- clhs(s, size = 30, iter = 1000, progress = FALSE) 
main &lt;- &quot;Amostra pelo Hipercubo Latino Condicionado (cLHS)&quot;
plot(
  grid@coords, type = &quot;n&quot;, asp = 1, main = main,
  xlab = &quot;Longitude (m)&quot;, ylab = &quot;Latitude (m)&quot;)
image(
  grid, &quot;cluster.cluster&quot;, col = terrain.colors(10), axes = TRUE, add = TRUE)
points(pts, pch = 21, cex = 0.75)
leg &lt;- paste(&quot;Amostras (n = &quot;, length(pts), &quot;)&quot;, sep = &quot;&quot;)
legend(635700, 7483400, legend = leg, pch = 21, bty = &quot;n&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="identifica√ß√£o-de-tend√™ncia-espacial-e-estimativa-optimclhs" class="section level4">
<h4>Identifica√ß√£o de tend√™ncia espacial e estimativa (optimCLHS)</h4>
<p>Essa √© uma otimiza√ß√£o de configura√ß√µes de amostra para identifica√ß√£o de tend√™ncia espacial. As fun√ß√µes de otimiza√ß√£o foram implementadas no pacote <em>spsann</em> do <em>R</em>.
Esse m√©todo busca otimizar uma configura√ß√£o de amostra para identifica√ß√£o e estimativa de tend√™ncia espacial usando o m√©todo proposta por <span class="citation"><a href="#ref-Minasny2006" role="doc-biblioref">Minasny and McBratney</a> (<a href="#ref-Minasny2006" role="doc-biblioref">2006</a>)</span>, m√©todo anteriormente citado, conhecido como cLHS. Nesse m√©todo otimizado, uma fun√ß√£o de utilidade <em>U</em> √© definida para que a amostra reproduza a distribui√ß√£o marginal e a matriz de correla√ß√£o das covari√°veis num√©ricas e as propor√ß√µes de classe do fator covari√°veis (cLHS). A fun√ß√£o de utilidade √© obtida agregando tr√™s fun√ß√µes objetivas: <em>O1</em>, <em>O2</em> e <em>O3</em>. Nesse exemplo assim com no cLHS usamos como vari√°veis auxiliares (covari√°veis) a eleva√ß√£o, declividade e SAVI.</p>
<pre class="r"><code>candi &lt;- grid1[, 21:22]; names(candi)[1] &lt;- &quot;x&quot; ;names(candi)[2] &lt;- &quot;y&quot;
covars &lt;- grid1[, c(1,2,20)]
schedule &lt;- scheduleSPSANN(
  chains = 1, initial.temperature = 0.001, x.max =  635865.8, y.max = 7483684,
  x.min = 0, y.min = 0, cellsize = 40)
set.seed(2001)
pts &lt;- spsann::optimCLHS(
  points = 30, candi = candi, covars = covars, use.coords = TRUE,
  clhs.version = &quot;update&quot;,  weights = list(O1 = 0.5, O3 = 0.5), schedule = schedule)
main &lt;- &quot;Identifica√ß√£o de tend√™ncia espacial e estimativa (optimCLHS)&quot;
plot(
  grid@coords, type = &quot;n&quot;, asp = 1, main = main,
  xlab = &quot;Longitude (m)&quot;, ylab = &quot;Latitude (m)&quot;)
image(
  grid, &quot;cluster.cluster&quot;, col = terrain.colors(10), axes = TRUE, add = TRUE)
points(pts$points[, 2:3], pch = 21, cex = 0.75)
leg &lt;- paste(&quot;Amostras (n = &quot;, length(pts), &quot;)&quot;, sep = &quot;&quot;)
legend(635700, 7483400, legend = leg, pch = 21, bty = &quot;n&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
</div>
<div id="otimiza√ß√£o-de-configura√ß√µes-de-amostra-para-interpola√ß√£o-espacial-optimmssd" class="section level4">
<h4>Otimiza√ß√£o de configura√ß√µes de amostra para interpola√ß√£o espacial (optimMSSD)</h4>
<p>Otimiza√ß√£o para estimativa de tend√™ncias espaciais. Esse √© um tipo de configura√ß√£o amostral espacial otimizada no espa√ßo geogr√°fico para fins de interpola√ß√£o espacial usando krigagem. O crit√©rio utilizado √© a m√©dia ao quadrado da dist√¢ncia mais curta (MSSD, ingl√™s) entre pontos de amostragem e pontos de predi√ß√£o.
Amostragem por cobertura espacial: A amostragem por cobertura espacial baseia-se no conhecimento de que a varia√ß√£o da krigagem depende da dist√¢ncia entre os pontos da amostra. Assim, quanto melhor o ‚Äòspread‚Äô dos pontos da amostra no dom√≠nio espacial, menor a varia√ß√£o da krigagem. Essa abordagem √© semelhante √† grade regular de ponto, no entanto uma grade regular geralmente √© sub-√≥tima para √°reas irregulares <span class="citation">(<a href="#ref-Walvoort2010" role="doc-biblioref">Walvoort et al., 2010</a>)</span>.</p>
<pre class="r"><code>pts &lt;- spsann::optimMSSD(
  points = 30, candi = candi, schedule = schedule)
main &lt;- &quot;Otimiza√ß√£o de amostra para interpola√ß√£o espacial (optimMSSD)&quot;
plot(
  grid@coords, type = &quot;n&quot;, asp = 1, main = main,
  xlab = &quot;Longitude (m)&quot;, ylab = &quot;Latitude (m)&quot;)
image(
  grid, &quot;cluster.cluster&quot;, col = terrain.colors(10), axes = TRUE, add = TRUE)
points(pts$points[, 2:3], pch = 21, cex = 0.75)
leg &lt;- paste(&quot;Amostras (n = &quot;, length(pts), &quot;)&quot;, sep = &quot;&quot;)
legend(635700, 7483400, legend = leg, pch = 21, bty = &quot;n&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-9-1.png" width="672" />
<strong>Para mais e informa√ß√µes sobre fun√ß√µes implementadas no R para otimiza√ß√£o amostral, voc√™s podem consultar o o pacote <a href="https://rdrr.io/cran/spsann/">spsann</a></strong></p>
</div>
</div>
</div>
<div id="amostragem-probabil√≠stica" class="section level2">
<h2>Amostragem probabil√≠stica</h2>
<p>A amostragem probabil√≠stica √© uma t√©cnica de amostragem em que a amostra de uma popula√ß√£o, no caso uma cole√ß√£o de perfis de solo ou <em>pedon</em> de toda √°rea, √© escolhida usando um m√©todo baseado na teoria da probabilidade. Para que um perfil (ou ponto amostral) seja considerado uma amostra probabil√≠stica, ele deve ser selecionado usando uma sele√ß√£o aleat√≥ria. Nesse tipo de amostragem todo e qualquer local possui alguma chance de ser amostrado, mesmo que alguns tenham maior chance do que outros. No caso da modelagem espacial do solo, a amostragem probabil√≠stica costuma ser usada para a valida√ß√£o das predi√ß√µes espaciais <span class="citation">(<a href="#ref-BrusEtAl2011" role="doc-biblioref">Brus et al., 2011</a>)</span>. Entretanto, ela tamb√©m pode ser usada para obter observa√ß√µes para a calibra√ß√£o dos modelos preditivos ou serem usadas para valida√ß√£o e calibra√ß√£o em abordagens como na valida√ß√£o cruzada <em>leave-one-out</em> (LOO-CV), <em>K-folders</em> (k-folders-CV) <span class="citation">(<a href="#ref-BrusEtAl2011" role="doc-biblioref">Brus et al., 2011</a>)</span>.</p>
<div id="amostragem-aleat√≥ria-simples" class="section level3">
<h3>Amostragem aleat√≥ria simples</h3>
<p>Amostragem aleat√≥ria simples √© a t√©cnica de amostragem onde todos os elementos que comp√µem o universo amostral t√™m id√™ntica probabilidade de serem selecionados para a amostra, ou seja, mesma probabilidade de inclus√£o e s√£o completamente independentes uns dos outros.
Seria como fazer um sorteio justo entre os indiv√≠duos do universo: No caso espec√≠fico da ci√™ncia do solo seria por exemplo selecionar qualquer <em>pedon</em> de um determinado tipo de solo (classe). Nesse tipo de amostragem √© apenas definido o n√∫mero de amostras, <em>n</em>.
Apesar de ser um m√©todo totalmente probabil√≠stico, ou seja, n√£o √© tendencioso ou enviesado, condi√ß√£o ideal para valida√ß√£o dos resultados das predi√ß√µes no MDS e AP, as amostras selecionadasnesse m√©todo podem ter irregularidade na sua distribui√ß√£o espacial, podendo haver forte agrupamento de alguns locais amostrais al√©m da presen√ßa de amplos espa√ßos vazios entre locais amostrais.
Isso significa que a amostras aleat√≥rias simples n√£o s√£o boas quando se busca amostras espacialmente representativas de uma √°rea de estudo e/ou que cubram toda a varia√ß√£o das caracter√≠sticas do terreno e paisagem.</p>
<pre class="r"><code>main &lt;- &quot;Amostra aleat√≥ria simples&quot;
plot(
  grid@coords, type = &quot;n&quot;, asp = 1, main = main,
  xlab = &quot;Longitude (m)&quot;, ylab = &quot;Latitude (m)&quot;)
image(
  grid, &quot;cluster.cluster&quot;, col = terrain.colors(10), axes = TRUE, add = TRUE)
set.seed(2001)
pts &lt;- grid[sampling::srswr(30, length(grid)) == 1, ]
set.seed(2001)
pts@coords &lt;- 
  pts@coords + matrix(runif(prod(dim(pts@coords)), min = -0.5, max = 0.5), ncol = 2) * 
  grid@grid@cellsize
points(pts, pch = 21, cex = 0.75)
leg &lt;- paste(&quot;Amostras (n = &quot;, length(pts), &quot;)&quot;, sep = &quot;&quot;)
legend(635700, 7483400, legend = leg, pch = 21, bty = &quot;n&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
</div>
<div id="amostragem-aleat√≥ria-estratificada-simples" class="section level3">
<h3>Amostragem aleat√≥ria estratificada simples</h3>
<p>As amostras estratificadas podem ser: <em>estratificada proporcional</em>, quando a quantidade de pontos √© proporcional a √°rea do estrato; <em>estratificada uniforme</em>, quando h√° o mesmo n√∫mero de amostras para todos os estratos; <em>estratificada √≥tima</em>, nesse caso o tamanho das amostras √© definido em propor√ß√£o com o desvio-padr√£o das vari√°veis estudadas. Isto √©, se obt√™m camadas maiores dos estratos com maior variabilidade interna para representar melhor o total da amostra nos grupos populacionais mais dif√≠ceis de estudar.
Assim como a amostragem aleat√≥ria simples, a amostragem aleat√≥ria estratificada simples pertence √† fam√≠lia de amostras probabil√≠sticas e consiste em dividir toda a popula√ß√£o ou o ‚Äúobjeto de estudo‚Äù em diferentes subgrupos ou estratos diferentes, de maneira que um indiv√≠duo pode fazer parte apenas de um √∫nico estrato ou camada. No caso espec√≠fico desse exemplo dividimos a √°rea em 10 estratos, que s√£o as nossas √°reas ambientalmente homog√™neas e pontos de amostragem s√£o selecionados aleatoriamente dentro de cada estrato.
Se as sub√°reas (estratos) s√£o internamente homog√™neas e heterog√™neas entre si o uso da amostragem aleat√≥ria estratificada reduz o erro amostral e pode ser, de certa forma, mais eficiente para valida√ß√£o dos resultados do MDS e AP, pois voc√™ certifica que n√£o ficaram espa√ßos vazios e que todos os tipos de solos (ou atributos do solo) tem no m√≠nimo um representante para valida√ß√£o partindo do pressuposto que os estratos ambientalmente heterog√™neos entre se representam solos diferentes, que poderiam n√£o terem sido amostrados na amostragem aleat√≥ria simples.</p>
<pre class="r"><code>main &lt;- &quot;Amostra aleat√≥ria estratificada simples&quot;
plot(
  grid@coords, type = &quot;n&quot;, asp = 1, main = main,
  xlab = &quot;Longitude (m)&quot;, ylab = &quot;Latitude (m)&quot;)
image(
  grid, &quot;cluster.cluster&quot;, col = terrain.colors(10), axes = TRUE, add = TRUE)
legend( &quot;topleft&quot;, title = &quot;√Åreas homog√™neas&quot;, fill = terrain.colors(10),
  legend = c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;),
  border = terrain.colors(10), bty = &quot;n&quot;)
n &lt;- round(30 * summary(grid$cluster.cluster) / length(grid))
set.seed(2001)
pts &lt;- sampling::strata(
  grid[order(grid$cluster.cluster), ], stratanames = &quot;cluster.cluster&quot;, size = n, 
  method = &quot;srswr&quot;)$ID_unit
pts &lt;- grid[order(grid$cluster.cluster), ][pts, ]
set.seed(2001)
pts@coords &lt;- pts@coords + 
  matrix(runif(prod(dim(pts@coords)), min = -0.5, max = 0.5), ncol = 2) * 
  grid@grid@cellsize
points(pts, pch = 21, cex = 0.75)
leg &lt;- paste(&quot;Amostras (n = &quot;, length(pts), &quot;)&quot;, sep = &quot;&quot;)
legend(635700, 7483400, legend = leg, pch = 21, bty = &quot;n&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
</div>
<div id="amostragem-aleat√≥ria-sistem√°tica" class="section level3">
<h3>Amostragem aleat√≥ria sistem√°tica</h3>
<p>Amostragem aleat√≥ria sistem√°tica √© uma t√©cnica dentro da categoria de <em>amostragem probabil√≠stica</em> ‚Äì que requer certo controle do marco amostral entre os indiv√≠duos selecionados junto com a probabilidade que sejam selecionados ‚Äì consiste em escolher um indiv√≠duo inicialmente de forma aleat√≥ria entre a popula√ß√£o e, posteriormente, selecionar para amostra cada en√©simo indiv√≠duo dispon√≠vel de forma sistem√°tica, pode ser por exemplo h√° uma dist√¢ncia pr√©-definida e seguindo uma determinada dire√ß√£o. O pesquisador deve ter certeza de que sistematiza√ß√£o escolhida n√£o reflete um certo padr√£o de caracter√≠sticas presentes no terreno. Se existir um padr√£o na popula√ß√£o e coincidir com a sistematiza√ß√£o do pesquisador, a aleatoriedade da t√©cnica de amostragem fica comprometida.</p>
<pre class="r"><code>main &lt;- &quot;Amostra aleat√≥ria sistem√°tica (malha quadrada)&quot;
plot(
  grid@coords, type = &quot;n&quot;, asp = 1, main = main,
  xlab = &quot;Longitude (m)&quot;, ylab = &quot;Latitude (m)&quot;)
image(
  grid, &quot;cluster.cluster&quot;, col = terrain.colors(10), axes = TRUE, add = TRUE)
legend(
  &quot;topleft&quot;, title = &quot;√Åreas homog√™neas&quot;, fill = terrain.colors(10),
  legend = c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;),
  border = terrain.colors(10), bty = &quot;n&quot;)
set.seed(2001)
pts &lt;- sp::spsample(grid, n = 30, type = &quot;regular&quot;)
points(pts, pch = 21, cex = 0.75)
polygon(pts@coords[c(1, 5, 6, 2, 1), ])
set.seed(1984)
points(sp::spsample(grid, n = 30, type = &quot;regular&quot;), pch = 20, cex = 0.75)
legend(636200, 7483450, legend = &quot;Amostras (2019)&quot;, pch = 21, bty = &quot;n&quot;)
legend(636200, 7483400, legend = &quot;Amostras (2020)&quot;, pch = 20, bty = &quot;n&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-12-1.png" width="672" /></p>
<pre class="r"><code>main &lt;- &quot;Amostra aleat√≥ria sistem√°tica (malha desalinhada)&quot;
plot(
  grid@coords, type = &quot;n&quot;, asp = 1, main = main,
  xlab = &quot;Longitude (m)&quot;, ylab = &quot;Latitude (m)&quot;)
image(
  grid, &quot;cluster.cluster&quot;, col = terrain.colors(10), axes = TRUE, add = TRUE)
legend(
  &quot;topleft&quot;, title = &quot;√Åreas homog√™neas&quot;, fill = terrain.colors(10),
  legend = c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;),
  border = terrain.colors(10), bty = &quot;n&quot;)
set.seed(2001)
pts &lt;- sp::spsample(grid, n = 31, type = &quot;nonaligned&quot;)
points(pts, pch = 21, cex = 0.75)
polygon(pts@coords[c(2, 7, 8, 3, 2), ])
leg &lt;- paste(&quot;Amostras (n = &quot;, length(pts), &quot;)&quot;, sep = &quot;&quot;)
legend(635700, 7483400, legend = leg, pch = 21, bty = &quot;n&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-12-2.png" width="672" /></p>
</div>
<div id="amostragem-aleat√≥ria-em-conglomerados" class="section level3">
<h3>Amostragem aleat√≥ria em conglomerados</h3>
<p>Amostra por conglomerados √© um procedimento de <em>amostragem probabil√≠stica</em> em que os elementos da popula√ß√£o s√£o selecionados aleatoriamente de forma natural por grupos (clusters). Os elementos da amostragem s√£o selecionados a partir da popula√ß√£o de maneira individual, um de cada vez. A separa√ß√£o desses clusters √© evidente numa popula√ß√£o quando os grupos s√£o mutuamente homog√™neos e internamente heterog√™neos.
Na amostragem aleat√≥ria em conglomerados um est√°gio ap√≥s sele√ß√£o de grupos todos os indiv√≠duos daquele grupo s√£o selecionados. No caso da amostragem em dois est√°gios ap√≥s a defini√ß√£o e sele√ß√£o de grupos uma amostra aleat√≥ria (por exemplo uma amostra aleat√≥ria simples) se tornam os elementos de cada grupo selecionado.</p>
<pre class="r"><code>main &lt;- &quot;Amostra aleat√≥ria em conglomerados (dois est√°gios)&quot;
plot(
  grid@coords, type = &quot;n&quot;, asp = 1, main = main,
  xlab = &quot;Longitude (m)&quot;, ylab = &quot;Latitude (m)&quot;)
image(
  grid, &quot;cluster.cluster&quot;, col = terrain.colors(10), axes = TRUE, add = TRUE)
legend(
  &quot;topleft&quot;, title = &quot;√Åreas homog√™neas&quot;, fill = terrain.colors(10),
  legend = c(&quot;1&quot;, &quot;2&quot;, &quot;3&quot;, &quot;4&quot;, &quot;5&quot;, &quot;6&quot;, &quot;7&quot;, &quot;8&quot;, &quot;9&quot;, &quot;10&quot;),
  border = terrain.colors(10), bty = &quot;n&quot;)
set.seed(2002)
pts &lt;- sp::spsample(grid, n = 33, type = &quot;clustered&quot;, nclusters = 10)
points(pts, pch = 21, cex = 0.75)
leg &lt;- paste(&quot;Amostras (n = &quot;, length(pts), &quot;)&quot;, sep = &quot;&quot;)
legend(635700, 7483400, legend = leg, pch = 21, bty = &quot;n&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-13-1.png" width="672" /></p>
</div>
<div id="se-voc√™-chegou-at√©-aqui-muito-bem" class="section level3">
<h3>Se voc√™ chegou at√© aqui muito bem !!!! üëèüëèüëè</h3>
</div>
</div>
</div>
<div id="refer√™ncias" class="section level1 unnumbered">
<h1>Refer√™ncias</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Brus2019" class="csl-entry">
Brus, D.J., 2019. <span class="nocase">Sampling for digital soil mapping: A tutorial supported by R scripts</span>. Geoderma 338, 464‚Äì480. <a href="https://doi.org/10.1016/j.geoderma.2018.07.036">https://doi.org/10.1016/j.geoderma.2018.07.036</a>
</div>
<div id="ref-BrusEtAl2011" class="csl-entry">
Brus, D.J., Kempen, B., Heuvelink, G.B.M., 2011. <span class="nocase">Sampling for validation of digital soil maps</span>. European Journal of Soil Science 62, 394‚Äì407. <a href="https://doi.org/10.1111/j.1365-2389.2011.01364.x">https://doi.org/10.1111/j.1365-2389.2011.01364.x</a>
</div>
<div id="ref-CambuleEtAl2013" class="csl-entry">
Cambule, A.H., Rossiter, D.G., Stoorvogel, J.J., 2013. <span class="nocase">A methodology for digital soil mapping in poorly-accessible areas</span>. Geoderma 192, 341‚Äì353. <a href="https://doi.org/10.1016/j.geoderma.2012.08.020">https://doi.org/10.1016/j.geoderma.2012.08.020</a>
</div>
<div id="ref-CarvalhoJunior2014" class="csl-entry">
Carvalho J√∫nior, W., Chagas, C.D.S., Muselli, A., Pinheiro, H.S.K., Pereira, N.R., Bhering, S.B., 2014. <span class="nocase">M<span class="nocase">√©</span>todo do hipercubo latino condicionado para a amostragem de solos na presen<span class="nocase">√ß</span>a de covari<span class="nocase">√°</span>veis ambientais visando o mapeamento digital de solos</span>. Revista Brasileira de Ci<span>√™</span>ncia do Solo 38, 386‚Äì396. <a href="https://doi.org/10.1590/S0100-06832014000200003">https://doi.org/10.1590/S0100-06832014000200003</a>
</div>
<div id="ref-Clifford2014" class="csl-entry">
Clifford, D., Payne, J.E., Pringle, M.J., Searle, R., Butler, N., 2014. <span class="nocase">Pragmatic soil survey design using flexible Latin hypercube sampling</span>. Computers and Geosciences 67, 62‚Äì68. <a href="https://doi.org/10.1016/j.cageo.2014.03.005">https://doi.org/10.1016/j.cageo.2014.03.005</a>
</div>
<div id="ref-deGruijter2006" class="csl-entry">
Gruijter, J. de, Brus, D., Bierkens, M.F.P., Knotters, M., 2006. <span class="nocase">Sampling for Natural Resource Monitoring</span>, in: Springer. Berlin, p. 334. <a href="https://doi.org/10.2136/sssaj2007.0018br">https://doi.org/10.2136/sssaj2007.0018br</a>
</div>
<div id="ref-IBGE2015" class="csl-entry">
IBGE, 2015. <span class="nocase">Manual T<span class="nocase">√©</span>cnico de Pedologia</span>, 3<span><span></span></span> Edi<span>√ß</span><span>√£</span>o. ed. Rio de Janeiro.
</div>
<div id="ref-Kidd2014" class="csl-entry">
Kidd, D., Malone, B., McBratney, Alex.B., Minasny, B., Webb, M., 2015. <span class="nocase">Operational sampling challenges to digital soilmapping in Tasmania, Australia</span>. Geoderma Regional 4, 1‚Äì10.
</div>
<div id="ref-McBratneyEtAl2003" class="csl-entry">
McBratney, A.B., Mendon√ßa-Santos, M.L., Minasny, B., 2003. <span class="nocase">On digital soil mapping</span>. Geoderma 117, 3‚Äì52. <a href="https://doi.org/10.1016/S0016-7061(03)00223-4">https://doi.org/10.1016/S0016-7061(03)00223-4</a>
</div>
<div id="ref-Minasny2007b" class="csl-entry">
Minasny, B., McBratney, A.B., 2007. <span class="nocase">Latin hypercube sampling as tool for digital soil mapping</span>. Developments in Soil Science 31, 153‚Äì606. <a href="https://doi.org/10.1016/S0166-2481(06)31012-4">https://doi.org/10.1016/S0166-2481(06)31012-4</a>
</div>
<div id="ref-Minasny2006" class="csl-entry">
Minasny, B., McBratney, A.B., 2006. <span class="nocase">A conditioned Latin hypercube method for sampling in the presence of ancillary information</span>. Computers and Geosciences 32, 1378‚Äì1388. <a href="https://doi.org/10.1016/j.cageo.2005.12.009">https://doi.org/10.1016/j.cageo.2005.12.009</a>
</div>
<div id="ref-Mulder2013" class="csl-entry">
Mulder, V.L., Bruin, S. de, Schaepman, M.E., 2013. <span class="nocase">Representing major soil variability at regional scale by constrained Latin Hypercube Sampling of remote sensing data</span>. International Journal of Applied Earth Observations and Geoinformation 21, 301‚Äì310. <a href="https://doi.org/10.1016/j.jag.2012.07.004">https://doi.org/10.1016/j.jag.2012.07.004</a>
</div>
<div id="ref-Nascimento2019" class="csl-entry">
Nascimento, C.W.R., 2019. <span class="nocase">Carlos wagner rodrigues do nascimento 2019</span> (PhD thesis).
</div>
<div id="ref-Oliveira-J2014" class="csl-entry">
Oliveira-J√∫nior, J.F., Delgado, R.C., Gois, G., Lannes, A., Dias, F.O., Souza, J.C., Souza, M., 2014. <span class="nocase">An<span class="nocase">√°</span>lise da precipita<span class="nocase">√ß</span><span class="nocase">√£</span>o e sua rela<span class="nocase">√ß</span><span class="nocase">√£</span>o com sistemas meteorol<span class="nocase">√≥</span>gicos em serop<span class="nocase">√©</span>dica, Rio de Janeiro</span>. Floresta e Ambiente 21, 140‚Äì149. <a href="https://doi.org/10.4322/floram.2014.030">https://doi.org/10.4322/floram.2014.030</a>
</div>
<div id="ref-RapidEye2012" class="csl-entry">
RapidEye, 2012. <span>RapidEye Mosaic‚Ñ¢ Product Specifications</span>.
</div>
<div id="ref-Roudier2012" class="csl-entry">
Roudier, P., Hewitt, A.E., Beaudette, D.E., 2012. <span class="nocase">A conditioned Latin hypercube sampling algorithm incorporating operational constraints</span>. Digital Soil Assessments and Beyond 227‚Äì231. <a href="https://doi.org/10.1201/b12728-46">https://doi.org/10.1201/b12728-46</a>
</div>
<div id="ref-Stumpf2016" class="csl-entry">
Stumpf, F., Schmidt, K., Behrens, T., Sch√∂nbrodt-stitt, S., Buzzo, G., Dumperth, C., Wadoux, A., Xiang, W., Scholten, T., 2016. <span class="nocase">Incorporating limited field operability and legacy soil samples in a hypercube sampling design for digital soil mapping</span>. Journal of Plant Nutrition and Soil Science 000, 1‚Äì11. <a href="https://doi.org/10.1002/jpln.201500313">https://doi.org/10.1002/jpln.201500313</a>
</div>
<div id="ref-Walvoort2010" class="csl-entry">
Walvoort, D.J.J., Brus, D.J., Gruijter, J.J. de, 2010. <span class="nocase">An R package for spatial coverage sampling and random sampling from compact geographical strata by k-means</span>. Computers and Geosciences 36, 1261‚Äì1267. <a href="https://doi.org/10.1016/j.cageo.2010.04.005">https://doi.org/10.1016/j.cageo.2010.04.005</a>
</div>
<div id="ref-Wang2012a" class="csl-entry">
Wang, J.F., Stein, A., Gao, B.B., Ge, Y., 2012. <span class="nocase">A review of spatial sampling</span>. Spatial Statistics 2, 1‚Äì14. <a href="https://doi.org/10.1016/j.spasta.2012.08.001">https://doi.org/10.1016/j.spasta.2012.08.001</a>
</div>
</div>
</div>
