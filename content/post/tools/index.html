---
date: "2020-06-15"
diagram: true
image:
  caption: 'Image credit: [**Elias**](https://www.instagram.com/eliasmendescosta/)'
  focal_point: ""
  placement: 3
math: true
title: Ferramentas pedométricas
subtitle: 'Ferramentas pedométricas para análise de pedologia quantitativa'
summary: ''
bibliography: [references.bib]
link-citations: true 
csl: [geoderma-regional.csl]
authors:
- admin
categories:
  - R
  - Programação
tags:
  - MDS
  - Pedometria
nocite: | 
  @R-bookdown
output:
  html_document:
    df_print: paged
---

<script src="{{< blogdown/postref >}}index_files/header-attrs/header-attrs.js"></script>


<div id="introdução" class="section level1">
<h1>Introdução</h1>
<p>Nesse tutorial serão abordados através do Algoritmo para Pedologia Quantitativa (AQP em inglês) e pacotes auxiliares, uma coleção de códigos, ideias, e plotes usando o software R <span class="citation">(<a href="#ref-R2019" role="doc-biblioref">R Core Team, 2019</a>)</span>. Toda a teoria por trás de grande parte do código pode ser encontrada no artigo <a href="https://www.sciencedirect.com/science/article/pii/S009830041200369X?via%3Dihub"><em>Algorithms for quantitative pedology: A toolkit for soil scientists</em></a> <span class="citation">(<a href="#ref-Beaudette2013" role="doc-biblioref">Beaudette et al., 2013</a>)</span>. Além disso alguns exemplos com aplicações das ferramentas podem ser encontrados em <span class="citation"><a href="#ref-Pinheiro2016" role="doc-biblioref">Pinheiro et al.</a> (<a href="#ref-Pinheiro2016" role="doc-biblioref">2016</a>)</span> e <span class="citation"><a href="#ref-Pinheiro2018" role="doc-biblioref">Pinheiro et al.</a> (<a href="#ref-Pinheiro2018" role="doc-biblioref">2018</a>)</span>. Para fins didáticos o tutorial foi dividido em três partes e os pacotes usados serão <code>soilDB</code>, que contém uma base de dados de solos para análises pedométricas, <code>AQP</code> que contém as principais ferramentas de pedologia quantitativa usadas no tutorial, <code>sharpshootR</code> que contém uma coelção de funções que dão suporte ao levantamento e exploração de dados de solo, <code>SP</code> um pacote que fornece classes e métodos para dados espaciais: pontos, linhas, polígonos e grades, <code>Hmisc</code> que contém muitas funções úteis para análise de dados, gráficos de alto nível, operações utilitárias, funções para calcular o tamanho de amostras, importar e manipular conjuntos de dados, imputar valores ausentes, criação avançada de tabelas, análise de cluster entre outras funções, <code>lattice</code> que é um sistema de visualização de dados de alto nível, poderoso e elegante, com ênfase em dados multivariados, <code>MASS</code> com funções e conjuntos de dados para apoiar Venables e Ripley, <strong>Modern Applied Statistics with S</strong>, <code>plyr</code> que contém um conjunto de ferramentas que resolve problemas tais como: Divisão, aplicação e combinação de dados e <code>cluster</code> que é um pacote com métodos para análise de componentes principais (PCA) e cluster a fim de encontrar grupos em conjunto de dados.</p>
<div id="base-de-dados-dos-exercícios" class="section level2">
<h2>Base de dados dos exercícios</h2>
<p>Todos os dados usados nos exercícios ou são do pacote <code>AQP</code> ou são do pacote <code>soilDB</code>. Muitas das informações contidas nesse tutorial foram extraídas do <a href="http://ncss-tech.github.io/AQP/">projeto do AQP</a> e todo crédito é dado ao autor.</p>
<pre class="r"><code># Carregando os pacotes no R
library(soilDB) 
library(aqp)  
library(sharpshootR) 
library(sp) 
library(Hmisc)
library(lattice)
library(MASS)
library(plyr)
library(cluster)</code></pre>
</div>
</div>
<div id="parte-i" class="section level1">
<h1>Parte I</h1>
<p>Na parte I serão abordadas características das funções básicas do <em>AQP</em>, conceito de coleção de perfis de solos, <strong>SoilProfileCollection</strong>, e verificação da estrutura de dados na coleção, além de alguns plotes básicos.
A classe <strong>SoilProfileCollection</strong> foi projetada para simplificar o processo de trabalhar com a coleção de dados associados aos perfis de solo: dados em nível de local (site), dados em nível de horizonte, dados espaciais, dados de horizontes de diagnósticos, metadados e etc. Os exemplos listados abaixo devem ser copiados/colados deste documento e executados de forma interativa no R. Lembrando que antes de executar você deve instalar e carregar todas as bibliotecas (pacotes) mencionados.</p>
<div id="criação-de-objetos" class="section level2">
<h2>Criação de Objetos</h2>
<p>Os objetos <strong>SoilProfileCollection</strong> geralmente são criados através de objetos <em>data.frame</em> (tabelas retangulares de dados) que contêm pelo menos três colunas essenciais:</p>
<ul>
<li>Uma coluna de identificação que identifica exclusivamente grupos de horizontes, um perfil de solo (por exemplo, <em>pedons</em>)</li>
<li>Limites superiores do horizonte</li>
<li>Limites inferiores do horizonte</li>
</ul>
<p>O <em>data.frame</em> deve ser pré-classificado de acordo com o ID do perfil e o limite superior do horizonte. A notação de fórmula é usada para definir as colunas usadas para promover um objeto <em>data.frame</em>.</p>
<pre class="r"><code># Carregando dados de solos
# upgrade para SoilProfileCollection
# &#39;id&#39; é o nome da coluna que contém o ID do perfil
# &#39;top&#39; é o nome da coluna que contém os limite superior do horizonte
# &#39;bottom&#39; é o nome da coluna que contém os limite inferior do horizonte
data(sp1) # Conjunto de dados sp4 do pacote AQP (data.frame)
aqp::depths(sp1) &lt;- id ~ top + bottom 
aqp::site(sp1) &lt;- ~ group </code></pre>
</div>
<div id="acessando-configurando-e-substituindo-dados" class="section level2">
<h2>Acessando, configurando e substituindo dados</h2>
<p>As funções de acessar são usadas para extrair componentes específicos dos objetos <strong>SoilProfileCollection</strong>.</p>
<pre class="r"><code># Métodos para inspeção dos objetos
aqp::idname (sp1) # auto-explicativo</code></pre>
<pre><code>## [1] &quot;id&quot;</code></pre>
<pre class="r"><code>aqp::horizonDepths(sp1) # auto-explicativo</code></pre>
<pre><code>## [1] &quot;top&quot;    &quot;bottom&quot;</code></pre>
<pre class="r"><code>aqp::depth_units(sp1) # defaults &#39;cm&#39;</code></pre>
<pre><code>## [1] &quot;cm&quot;</code></pre>
<pre class="r"><code>aqp::metadata(sp1) # </code></pre>
<pre><code>## $aqp_df_class
## [1] &quot;data.frame&quot;
## 
## $aqp_group_by
## [1] &quot;&quot;
## 
## $aqp_hzdesgn
## [1] &quot;&quot;
## 
## $aqp_hztexcl
## [1] &quot;&quot;
## 
## $depth_units
## [1] &quot;cm&quot;
## 
## $stringsAsFactors
## [1] FALSE
## 
## $original.order
##  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25
## [26] 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50
## [51] 51 52 53 54 55 56 57 58 59 60</code></pre>
<pre class="r"><code>aqp::profile_id(sp1) # vector com IDs dos perfis</code></pre>
<pre><code>## [1] &quot;P001&quot; &quot;P002&quot; &quot;P003&quot; &quot;P004&quot; &quot;P005&quot; &quot;P006&quot; &quot;P007&quot; &quot;P008&quot; &quot;P009&quot;</code></pre>
<pre class="r"><code>aqp::horizonNames(sp1) # coluna com osnomes dos dados dos horizontes</code></pre>
<pre><code>##  [1] &quot;id&quot;               &quot;top&quot;              &quot;bottom&quot;           &quot;bound_distinct&quot;  
##  [5] &quot;bound_topography&quot; &quot;name&quot;             &quot;texture&quot;          &quot;prop&quot;            
##  [9] &quot;structure_grade&quot;  &quot;structure_size&quot;   &quot;structure_type&quot;   &quot;stickiness&quot;      
## [13] &quot;plasticity&quot;       &quot;field_ph&quot;         &quot;hue&quot;              &quot;value&quot;           
## [17] &quot;chroma&quot;           &quot;hzID&quot;</code></pre>
<pre class="r"><code>aqp::siteNames(sp1) # coluna com os nomes do dados dos locais (site data)</code></pre>
<pre><code>## [1] &quot;id&quot;    &quot;group&quot;</code></pre>
<pre class="r"><code>length(sp1) # número de perfis na coleção</code></pre>
<pre><code>## [1] 9</code></pre>
<pre class="r"><code>nrow(sp1) # número de horizontes na coleção</code></pre>
<pre><code>## [1] 60</code></pre>
<pre class="r"><code>names(sp1) # nomes de colunas dos dados do site e do horizonte, concatenados em um único vetor</code></pre>
<pre><code>##          horizons1          horizons2          horizons3          horizons4 
##               &quot;id&quot;              &quot;top&quot;           &quot;bottom&quot;   &quot;bound_distinct&quot; 
##          horizons5          horizons6          horizons7          horizons8 
## &quot;bound_topography&quot;             &quot;name&quot;          &quot;texture&quot;             &quot;prop&quot; 
##          horizons9         horizons10         horizons11         horizons12 
##  &quot;structure_grade&quot;   &quot;structure_size&quot;   &quot;structure_type&quot;       &quot;stickiness&quot; 
##         horizons13         horizons14         horizons15         horizons16 
##       &quot;plasticity&quot;         &quot;field_ph&quot;              &quot;hue&quot;            &quot;value&quot; 
##         horizons17         horizons18               site 
##           &quot;chroma&quot;             &quot;hzID&quot;            &quot;group&quot;</code></pre>
<pre class="r"><code>min(sp1) # profundidade de perfil mais raso da coleção</code></pre>
<pre><code>## [1] 59</code></pre>
<pre class="r"><code>max(sp1) # profundidade de perfil mais profundo da coleção</code></pre>
<pre><code>## [1] 240</code></pre>
</div>
<div id="dados-do-horizonte-e-do-site-local" class="section level2">
<h2>Dados do horizonte e do site (local)</h2>
<p>Normalmente, os dados do horizonte e do site são os componentes mais importantes dos objetos SoilProfileCollection. Ambos são armazenados internamente como objetos data.frame; com uma ou mais linhas (por ID do perfil) na tabela do horizonte e uma linha (por ID do perfil) na tabela do site. As colunas de qualquer tabela podem ser acessadas com a notação <code>$</code>. Novos dados podem ser atribuídos a qualquer tabela da mesma maneira, desde que o comprimento dos novos dados sejam:</p>
<ul>
<li>Mesmo tamanho que o número de perfis na coleção (o destino é a tabela de sites).</li>
<li>Mesmo comprimento que o número de horizontes na coleção (o destino é a tabela do horizonte).</li>
</ul>
</div>
<div id="plotando-soilprofilecollection" class="section level2">
<h2>Plotando <strong>SoilProfileCollection</strong></h2>
<p>O método <code>plot()</code> para objetos <strong>SoilProfileCollection</strong> gera esboços de perfis na coleção com base nos limites dos horizontes, alinhados verticalmente a uma sequência inteira de um ao número total de perfis. Os nomes dos horizontes são extraídos automaticamente de um nome de atributo no nível do horizonte (se presente) ou por meio de um atributo alternativo fornecido como argumento: <code>name = 'nomedacoula'</code>. As cores dos horizontes são geradas automaticamente a partir do atributo no nível do horizonte <code>soil_color</code>, ou qualquer outro atributo da descrição de cor compatível com R, fornecido como argumento: <code>color = 'nomedacoula'</code>. Essa função é altamente personalizável; portanto, é prudente consultar a ajuda <code>(plotSPC)</code> de tempos em tempos. As cores do solo na notação Munsell podem ser convertidas em cores compatíveis com R via <code>munsell2rgb()</code>.</p>
<pre class="r"><code>data(sp4) # Conjunto de dados sp4 do pacote AQP (data.frame)
aqp::depths(sp4) &lt;- id ~ top + bottom 
# Atribuição de novos dados a atributos existentes ou novos
sp4$elevation &lt;- rnorm(n=length(sp4), mean=1000, sd=150) # no nível do site, com base no comprimento dos dados atribuídos
sp4$thickness &lt;- sp4$bottom - sp4$top # nível do horizonte
# Extração de atributos específicos por nome
sp4$clay # Vetor de conteúdo de argila (dados do horizonte)</code></pre>
<pre><code>##  [1] 21 27 32 55 25 34  3 15 27 32 25 31 33 13 21 23 15 17 12 19 14 14 22 25 40
## [26] 51 67 24 25 32</code></pre>
<p>Os dados do horizonte e do local (site) também podem ser modificados por extração para um data.frame, seguidos pela substituição (dados do horizonte) ou junção (dados do site). Observe que, embora essa abordagem ofereça a maior flexibilidade, ela também é a mais perigosa. A substituição dos dados do horizonte por novos dados que não estão exatamente de acordo com a classificação original pode corromper seu <strong>SoilProfileCollection</strong>.</p>
<pre class="r"><code># extrair dados os horizontes para o data.frame
h &lt;- aqp::horizons(sp4)
# Adicionar uma nova coluna e salvar de volta no objeto
h$random.numbers &lt;- rnorm(n=nrow(h), mean=0, sd=1)
# repor dados originais dos horizontes com versão modificada
#!a ordem das linhas não deve ser alterada!
horizons(sp4) &lt;- h
# extrair dados do site para o data.frame
s &lt;- aqp::site(sp4)
# Adicionar um grupo para o site fake
s$group &lt;- base::factor(rep(c(&#39;A&#39;, &#39;B&#39;), length.out=nrow(s)))
# junte novos dados do site com dados anteriores: os dados antigos não são substituídos
site(sp4) &lt;- s
# Verificar
sp4</code></pre>
<pre><code>## SoilProfileCollection with 10 profiles and 30 horizons
## profile ID: id  |  horizon ID: hzID 
## Depth range: 16 - 49 cm
## 
## ----- Horizons (6 / 30 rows  |  10 / 16 columns) -----
##      id hzID top bottom name   K   Mg  Ca CEC_7 ex_Ca_to_Mg
##  colusa    1   0      3    A 0.3 25.7 9.0  23.0        0.35
##  colusa    2   3      8  ABt 0.2 23.7 5.6  21.4        0.23
##  colusa    3   8     30  Bt1 0.1 23.2 1.9  23.7        0.08
##  colusa    4  30     42  Bt2 0.1 44.3 0.3  43.0        0.01
##   glenn    5   0      9    A 0.2 21.9 4.4  18.8        0.20
##   glenn    6   9     34   Bt 0.3 18.9 4.5  27.5        0.20
## [... more horizons ...]
## 
## ----- Sites (6 / 10 rows  |  3 / 3 columns) -----
##         id elevation group
##     colusa 1005.8124     A
##      glenn  930.8280     B
##      kings 1185.8329     A
##   mariposa  793.5652     B
##  mendocino 1148.8530     A
##       napa 1176.2684     B
## [... more sites ...]
## 
## Spatial Data:
## [EMPTY]</code></pre>
<pre class="r"><code># plot com separação de grupos
aqp::groupedProfilePlot(sp4, groups=&#39;group&#39;, max.depth=60, group.name.offset = -5, id.style=&#39;side&#39;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
<pre class="r"><code># Esboços Temáticos
sp4$clay # </code></pre>
<pre><code>##  [1] 21 27 32 55 25 34  3 15 27 32 25 31 33 13 21 23 15 17 12 19 14 14 22 25 40
## [26] 51 67 24 25 32</code></pre>
<pre class="r"><code>par(mar=c(1,1,3,1)) # tighter figure margins
plot(sp4, name=&#39;name&#39;, color=&#39;clay&#39;,cex.names=0.5,cex.id=0.5, id.style=&#39;top&#39;,col.legend.cex=1,family=&quot;serif&quot;, col.label=&#39;Argila&#39;, )</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-7-2.png" width="672" /></p>
<pre class="r"><code>sp4$Ca # </code></pre>
<pre><code>##  [1]  9.0  5.6  1.9  0.3  4.4  4.5  1.4  7.0  4.4  5.8  6.2  6.2  4.4  2.2  3.4
## [16]  3.7 24.1 21.5  0.7  5.6  3.5  2.0  6.6  4.1  3.5  1.5  0.8 16.3 16.5 13.7</code></pre>
<pre class="r"><code>par(mar=c(1,1,3,1)) # tighter figure margins
plot(sp4, name=&#39;name&#39;, color=&#39;Ca&#39;,cex.names=0.5,cex.id=0.5, id.style=&#39;top&#39;,col.legend.cex=1,
     col.label=&#39;Ca&#39;, family=&quot;serif&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-7-3.png" width="672" /></p>
<pre class="r"><code>sp4$name # </code></pre>
<pre><code>##  [1] &quot;A&quot;   &quot;ABt&quot; &quot;Bt1&quot; &quot;Bt2&quot; &quot;A&quot;   &quot;Bt&quot;  &quot;A&quot;   &quot;Bt1&quot; &quot;Bt2&quot; &quot;A&quot;   &quot;Bt1&quot; &quot;Bt2&quot;
## [13] &quot;Bt3&quot; &quot;A&quot;   &quot;Bt1&quot; &quot;Bt2&quot; &quot;A&quot;   &quot;Bt&quot;  &quot;A&quot;   &quot;Bt&quot;  &quot;A&quot;   &quot;Bt&quot;  &quot;A1&quot;  &quot;A2&quot; 
## [25] &quot;AB&quot;  &quot;Bt1&quot; &quot;Bt2&quot; &quot;A&quot;   &quot;Bt1&quot; &quot;Bt2&quot;</code></pre>
<pre class="r"><code>par(mar=c(2,2,3,2)) # tighter figure margins
plot(sp4, name=&#39;name&#39;, color=&#39;name&#39;, col.palette=RColorBrewer::brewer.pal(9, &#39;Set1&#39;), col.label=&#39;Nomes dos Horizontes&#39;, 
     cex.names=0.5)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-7-4.png" width="672" /></p>
<pre class="r"><code>###############
### Boxplot ###
# Aqui usaremos o conjunto sp1
sp1$name1 &lt;- aqp::generalize.hz(sp1$name, 
                           new=c(&#39;A&#39;,&#39;AB&#39;, &#39;BA&#39;,&#39;B&#39;,&#39;BC&#39;, &#39;C&#39;, &#39;E&#39;, &#39;AE&#39;, &#39;O&#39;, &#39;H&#39;, &#39;R&#39;, &#39;2C&#39;, &#39;3C&#39;, &#39;3B&#39;, &#39;3A&#39;), 
                           pat=c(&#39;^A&#39;,&#39;^AB&#39;,&#39;^BA&#39;,&#39;^B&#39;,&#39;^BC&#39;,&#39;^C&#39;, &#39;^E&#39;, &#39;^AE&#39;, &#39;^O&#39;, &#39;^H&#39;, &#39;^R&#39;, &#39;^2C&#39;, &#39;^3C&#39;,&#39;^3B&#39;, &#39;^3A&#39; ))

# compute horizon mid-points 
sp1$mid &lt;- with(horizons(sp1), (top+ bottom)/2)
# sort horizon designation by group-wise median values 
hz.designation.by.median.depths &lt;- names(sort(tapply(sp1$mid, sp1$name1, median)))
# plot the distribution of horizon mid-points by designation 
lattice::bwplot(mid ~ factor(name, levels=hz.designation.by.median.depths),
       data=horizons(sp1),       
       ylim=c(200, 0), ylab=&#39;Profundidade do ponto médio do horizonte (cm)&#39;,       
       scales=list(y=list(tick.number=10)),       
       panel= function ( ... ) {
         panel.abline(h=seq(0, 180, by=10), v=1:length(hz.designation.by.median.depths), col=grey(0.8), lty=3)    
         panel.bwplot( ... ) })</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-7-5.png" width="672" /></p>
<pre class="r"><code>lattice::bwplot(prop~ factor(name1, levels=hz.designation.by.median.depths),
       data=horizons(sp1),       
       ylab=&#39;Profundidade&#39;,       
       scales=list(y=list(tick.number=10)),       
       panel= function ( ... ) {  
         panel.abline(h=seq(0, 600, by=50), v=1:length(hz.designation.by.median.depths), col=grey(0.8), lty=3)  
         panel.bwplot( ... ) })</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-7-6.png" width="672" /></p>
</div>
</div>
<div id="parte-ii" class="section level1">
<h1>Parte II</h1>
<div id="funções-de-fatiamento-slice" class="section level2">
<h2>Funções de fatiamento (slice)</h2>
<p>Coleções de perfis de solo podem ser fatiadas (ou reamostradas) em intervalos regulares de profundidade com a função <code>slice()</code>. A estrutura de fatiamento e as variáveis de interesse são definidas por meio de notação de fórmula: seq ~ var.1 + var.2 + var.3 + … onde seq é uma sequência de números inteiros [por exemplo, 0:15 ou c (5,10,15,20) etc.] e var.1 + var.2 + var.3 + … são atributos no horizonte que se deseja fatiar. As variáveis contínuas e categóricas podem ser nomeadas no lado direito da fórmula. Os resultados retornados pela função <code>slice ()</code> são <strong>SoilProfileCollection</strong> ou <strong>data.frame</strong> quando chamados com o argumento opcional <em>just.the.data = TRUE</em>. Por exemplo, para dividir nosso conjunto de dados de amostra em intervalos de 1 cm, de 0 a 15 cm:</p>
<pre class="r"><code># fatiar dados
sliced &lt;- aqp::slice(sp4, fm= 0:50 ~ sand + silt + clay)
# verificar o resultado
class(sliced)</code></pre>
<pre><code>## [1] &quot;SoilProfileCollection&quot;
## attr(,&quot;package&quot;)
## [1] &quot;aqp&quot;</code></pre>
<pre class="r"><code># fatiar de 0 até a profundidade máxima dos perfis da coleção
sliced &lt;- aqp::slice(sp4, fm= 0:max(sp4) ~ sand + silt + clay)
# Extraia todos os dados na faixa de 5--10 cm:
plot(sliced[, 5:10])</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-8-1.png" width="672" /></p>
<pre class="r"><code># Extraia todos os dados na faixa de 25 a 50 cm:
plot(sliced[, 25:50])</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-8-2.png" width="672" /></p>
<pre class="r"><code># Extraia todos os dados na faixa de 0--5, 10--20 e 40--50 cm:
plot(sliced[, c(0:5, 10:20, 40:50)])</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-8-3.png" width="672" /></p>
</div>
<div id="agregando-coleções-de-perfis-de-solo-em-slabs-regulares" class="section level2">
<h2>Agregando coleções de perfis de solo em “slabs” regulares</h2>
<p>O resumo detalhado dos atributos no nível de horizonte é realizado com a função <code>slab()</code>. Os critérios de agrupamento de perfis e a seleção de atributos do horizonte são parametrizados por meio da fórmula: grupos ~ var1 + var2 + var3 onde variáveis nomeadas são agregadas em grupos ou onde variáveis nomeadas são agregadas em toda a coleção com fórmula: coleção ~ var1 + var2 + var3. A função de resumo padrão <em>(slab.fun)</em> calcula os percentis 5, 25, 50, 75 e 95 através do estimador de quantil Harrell-Davis.</p>
<p>A estrutura de profundidade (“slabs”) sobre a qual os resumos são calculados é definida com o argumento <code>slab.structure</code> usando:</p>
<ul>
<li>Um único número inteiro (por exemplo, 10): os dados são agregados em uma sequência regular de <em>slabs</em> de 10 unidades de espessura.</li>
<li>Um vetor de 2 números inteiros [por exemplo, c (50, 60)]: os dados são agregados em profundidades que variam de 50 a 60 unidades.</li>
<li>Um vetor de 3 ou mais números inteiros [por exemplo, c (0, 5, 10, 50, 100)]: os dados são agregados nas profundidades que variam de 0 a 5, 5 a 10, 10 a 50, 50 a 100 unidades. Essa é por exemplo umas das formas usadas para harmonização de dados em profundidades pré-definidas como é o caso do projeto <strong>GlobalSoilMap project</strong> <span class="citation">(<a href="#ref-Arrouays2017" role="doc-biblioref">Arrouays et al., 2017</a>)</span> que é de 0-5, 5-15, 15-30, 30-60, 60-100, 100-200 cm.</li>
</ul>
<pre class="r"><code># Agregar coleções de perfis de solo em “slabs” (conjuntos) regulares
# calculando o valor médio ignorando os dados ausentes
aqp::slab(sp4, fm= ~ sand + silt + clay, slab.structure=c(0,10), slab.fun=mean, na.rm=TRUE)</code></pre>
<pre><code>##   variable all.profiles value top bottom contributing_fraction
## 1     sand            1 47.63   0     10                     1
## 2     silt            1 31.15   0     10                     1
## 3     clay            1 21.11   0     10                     1</code></pre>
<pre class="r"><code># Novamente, desta vez em grupos definidos por um atributo no nível do site:
aqp::slab(sp4, fm= group ~ sand + silt + clay, slab.structure=c(0,10), slab.fun=mean, na.rm=TRUE)</code></pre>
<pre><code>##   variable group value top bottom contributing_fraction
## 1     sand     A 48.26   0     10                     1
## 2     silt     A 31.52   0     10                     1
## 3     clay     A 20.30   0     10                     1
## 4     sand     B 47.00   0     10                     1
## 5     silt     B 30.78   0     10                     1
## 6     clay     B 21.92   0     10                     1</code></pre>
<pre class="r"><code># Novamente, desta vez em várias faixas de profundidade
aqp::slab(sp4, fm= ~ sand + silt + clay, slab.structure=c(0,5,15,30,60), slab.fun=mean, na.rm=TRUE)</code></pre>
<pre><code>##    variable all.profiles    value top bottom contributing_fraction
## 1      sand            1 48.54000   0      5             1.0000000
## 2      sand            1 45.96000   5     15             1.0000000
## 3      sand            1 39.29310  15     30             0.7733333
## 4      sand            1 30.36923  30     60             0.3421053
## 5      silt            1 32.40000   0      5             1.0000000
## 6      silt            1 29.15000   5     15             1.0000000
## 7      silt            1 30.37069  15     30             0.7733333
## 8      silt            1 31.00000  30     60             0.3421053
## 9      clay            1 19.00000   0      5             1.0000000
## 10     clay            1 24.79000   5     15             1.0000000
## 11     clay            1 30.20690  15     30             0.7733333
## 12     clay            1 38.38462  30     60             0.3421053</code></pre>
<pre class="r"><code># Novamente, desta vez em fatias de 1 cm, calculando quantis
agg &lt;- aqp::slab(sp4, fm= ~ sand + silt + clay)

# Agregando coleções de perfis de solo ao longo de períodos regulares “Slabs”
lattice::xyplot(top ~ p.q50 | variable, data=agg, ylab=&#39;Profundidade (cm)&#39;,
       xlab=&#39;Mediana delimitada pelos percentis 25 e 75&#39;,
       lower=agg$p.q25, upper=agg$p.q75, ylim=c(50,-2),
       panel=panel.depth_function,
       alpha=0.25, sync.colors=TRUE,
       par.settings=list(superpose.line=list(col=&#39;RoyalBlue&#39;, lwd=2)),
       prepanel=prepanel.depth_function,
       cf=agg$contributing_fraction, cf.col=&#39;black&#39;, cf.interval=5, 
       layout=c(3,1), strip=strip.custom(bg=grey(0.8)),
       scales=list(x=list(tick.number=4, alternating=3, relation=&#39;free&#39;))
)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-9-1.png" width="672" /></p>
</div>
<div id="análise-de-dissimilaridade-dendrogramas" class="section level2">
<h2>Análise de Dissimilaridade (Dendrogramas)</h2>
<p>Os dendrogramas são uma maneira conveniente de descrever a dissimilaridade entre pares (<em>pair-wise</em>), comumente associada ao tópico da análise de cluster.
O cálculo da dissimilaridade entre perfis é realizado usando a função <code>profile_compare()</code>. Os valores de dissimilaridade dependem da seleção de atributos [por exemplo, argila, CEC, pH etc.], parâmetro opcional de ponderação em profundidade <code>(k)</code> e uma profundidade máxima de avaliação <code>(max_d)</code>. Maiores informações dobre análise de dissimilaridade pode ser encontrado em <span class="citation"><a href="#ref-Beaudette2013" role="doc-biblioref">Beaudette et al.</a> (<a href="#ref-Beaudette2013" role="doc-biblioref">2013</a>)</span> e com exemplos de aplicação em <span class="citation"><a href="#ref-Pinheiro2016" role="doc-biblioref">Pinheiro et al.</a> (<a href="#ref-Pinheiro2016" role="doc-biblioref">2016</a>)</span> e <span class="citation"><a href="#ref-Pinheiro2018" role="doc-biblioref">Pinheiro et al.</a> (<a href="#ref-Pinheiro2018" role="doc-biblioref">2018</a>)</span>.</p>
<pre class="r"><code># Dissimilaridade usando o conjunto sp4
# usando Ex-Ca:Mg e CTC a pH 7
# sem ponderação de profundidade (k = 0)
# até uma profundidade máxima de 50 cm
d &lt;- aqp::profile_compare(sp4, vars=c(&#39;ex_Ca_to_Mg&#39;, &#39;CEC_7&#39;), k=0, max_d=50)

# Verificar matriz de distância
round(d, 1)</code></pre>
<pre><code>## Dissimilarities :
##                colusa glenn kings mariposa mendocino napa san benito shasta
## glenn            15.8                                                      
## kings            18.0  13.1                                                
## mariposa         17.4  20.6  25.5                                          
## mendocino        14.1   8.2  17.0     24.5                                 
## napa             33.5  24.9  30.5     39.3      22.2                       
## san benito       28.8  21.4  27.4     38.3      16.4 18.0                  
## shasta           19.2  13.6   8.7     26.6      17.6 34.8       23.3       
## shasta-trinity    8.4  16.9  22.3     18.6      17.0 30.9       28.3   23.3
## tehama           32.1  23.9  29.2     37.6      20.8  9.0       15.3   32.7
##                shasta-trinity
## glenn                        
## kings                        
## mariposa                     
## mendocino                    
## napa                         
## san benito                   
## shasta                       
## shasta-trinity               
## tehama                   29.2
## 
## Metric :  mixed ;  Types = I, I 
## Number of objects : 10</code></pre>
<pre class="r"><code># Análise hierárquica de cluster em um conjunto de dissimilaridades (Hierarchical Clustering)
h &lt;- stats::hclust(d)
# Melhor ajuste de margens
par(mar=c(4,3,2,3))

##Plotando dendrograma
plot(as.dendrogram(h))</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-10-1.png" width="672" /></p>
<pre class="r"><code>#stats::rect.hclust(h,5)

################
# Fazendo de outra forma com função diana (DIvisive ANAlysis Clustering)
# vizualize a matriz de dissimilaridade via cluster hierárquico divisivo
d.diana &lt;- cluster::diana(d)

## Plotando Dendograma
# esta função é do pacote sharpshootR
# requer alguns ajustes manuais
par(mar=c(1,1,5,1))
sharpshootR::plotProfileDendrogram(sp4, d.diana, scaling.factor = 0.8, y.offset = 5, width=0.25, color=&#39;ex_Ca_to_Mg&#39;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-10-2.png" width="672" /></p>
<pre class="r"><code># solos de interesse do levatamento Americano
s.list &lt;- c(&#39;hornitos&#39;, &#39;perkins&#39;, &#39;argonaut&#39;, &#39;inks&#39;, &#39;mokelumne&#39;,
            &#39;dunstone&#39;, &#39;auburn&#39;, &#39;pentz&#39;, &#39;pardee&#39;, &#39;peters&#39;, 
            &#39;amador&#39;, &#39;laniger&#39;)

# Buscar e converter dados em um SoilProfileCollection
s &lt;- soilDB::fetchOSD(s.list)
# Estimando a profundidade do solo com base na designação do horizontes
s$soil.depth &lt;- profileApply(s, FUN = max)

# plot profiles, order by soil depth
par(mar=c(0, 0, 0, 0))
plot(s, name=&#39;hzname&#39;, plot.order=order(s$soil.depth), cex.names=0.85, axis.line.offset=-5, width=0.25, id.style=&#39;top&#39;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-10-3.png" width="672" /></p>
<pre class="r"><code>d &lt;- SoilTaxonomyDendrogram(s, cex.taxon.labels=0.8, width=0.25, y.offset = 0.4)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-10-4.png" width="672" /></p>
</div>
</div>
<div id="parte-iii" class="section level1">
<h1>Parte III</h1>
<p>Nessa parte é usado outra base de dados do <code>soilDB</code>, são eles o conjunto <code>loafercreek</code> e o conjunto <code>mineralKing</code>, e aqui além de plots que marcam os horizontes diagnósticos de alguns perfis são feitos alguns plots que relacionam o perfil e a paisagem. Maiores comentários estão na linha de código</p>
<pre class="r"><code># Carregando onconjunto de dados de solos loafercreek
data(&quot;loafercreek&quot;)
# selecionar os 10 primeiros perfis
x &lt;- loafercreek[1:10, ]

#reconfigurando as margens porque o default é muito largo
par(mar=c(1,1,2,1))

# Alguns plots
plot(x)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-11-1.png" width="672" /></p>
<pre class="r"><code>plot(x, label=&#39;pedon_id&#39;, id.style=&#39;side&#39;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-11-2.png" width="672" /></p>
<pre class="r"><code>str(x)</code></pre>
<pre><code>## Formal class &#39;SoilProfileCollection&#39; [package &quot;aqp&quot;] with 9 slots
##   ..@ idcol       : chr &quot;peiid&quot;
##   ..@ hzidcol     : chr &quot;phiid&quot;
##   ..@ depthcols   : chr [1:2] &quot;hzdept&quot; &quot;hzdepb&quot;
##   ..@ metadata    :List of 8
##   .. ..$ aqp_df_class    : chr &quot;data.frame&quot;
##   .. ..$ aqp_group_by    : chr &quot;&quot;
##   .. ..$ aqp_hzdesgn     : chr &quot;&quot;
##   .. ..$ aqp_hztexcl     : chr &quot;&quot;
##   .. ..$ depth_units     : chr &quot;cm&quot;
##   .. ..$ stringsAsFactors: logi FALSE
##   .. ..$ original.order  : int [1:56] 1 2 3 4 5 6 7 8 9 10 ...
##   .. ..$ origin          : chr &quot;NASIS pedons&quot;
##   ..@ horizons    :&#39;data.frame&#39;: 56 obs. of  73 variables:
##   .. ..$ phiid               : chr [1:56] &quot;579662&quot; &quot;579661&quot; &quot;579660&quot; &quot;579659&quot; ...
##   .. ..$ peiid               : chr [1:56] &quot;115595&quot; &quot;115595&quot; &quot;115595&quot; &quot;115595&quot; ...
##   .. ..$ hzname              : chr [1:56] &quot;A&quot; &quot;BA&quot; &quot;BAt&quot; &quot;Bt1&quot; ...
##   .. ..$ genhz               : chr [1:56] NA NA NA NA ...
##   .. ..$ hzdept              : int [1:56] 0 5 10 28 51 74 0 5 10 28 ...
##   .. ..$ hzdepb              : num [1:56] 5 10 28 51 74 81 5 10 28 51 ...
##   .. ..$ bounddistinct       : chr [1:56] &quot;abrupt&quot; &quot;clear&quot; &quot;clear&quot; &quot;clear&quot; ...
##   .. ..$ boundtopo           : chr [1:56] &quot;smooth&quot; &quot;wavy&quot; &quot;smooth&quot; &quot;smooth&quot; ...
##   .. ..$ clay                : num [1:56] 15 20 25 29 35 NA 15 20 25 29 ...
##   .. ..$ silt                : num [1:56] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ sand                : num [1:56] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ fragvoltot          : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ texture             : chr [1:56] &quot;L&quot; &quot;L&quot; &quot;L&quot; &quot;CL&quot; ...
##   .. ..$ texcl               : chr [1:56] &quot;l&quot; &quot;l&quot; &quot;l&quot; &quot;cl&quot; ...
##   .. ..$ lieutex             : chr [1:56] NA NA NA NA ...
##   .. ..$ phfield             : num [1:56] 5.5 4.9 5.5 6 6 ...
##   .. ..$ effclass            : chr [1:56] &quot;none&quot; &quot;none&quot; &quot;none&quot; &quot;none&quot; ...
##   .. ..$ labsampnum          : chr [1:56] &quot;01P1566&quot; &quot;01P1567&quot; &quot;01P1568&quot; &quot;01P1569&quot; ...
##   .. ..$ rupresblkdry        : chr [1:56] &quot;moderately hard&quot; &quot;moderately hard&quot; &quot;slightly hard&quot; &quot;moderately hard&quot; ...
##   .. ..$ rupresblkmst        : chr [1:56] &quot;very friable&quot; &quot;very friable&quot; &quot;very friable&quot; &quot;very friable&quot; ...
##   .. ..$ rupresblkcem        : chr [1:56] NA NA NA NA ...
##   .. ..$ stickiness          : chr [1:56] &quot;nonsticky&quot; &quot;nonsticky&quot; &quot;slightly sticky&quot; &quot;slightly sticky&quot; ...
##   .. ..$ plasticity          : chr [1:56] &quot;slightly plastic&quot; &quot;slightly plastic&quot; &quot;slightly plastic&quot; &quot;moderately plastic&quot; ...
##   .. ..$ ksatpedon           : num [1:56] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ texture_class       : chr [1:56] &quot;l&quot; &quot;l&quot; &quot;l&quot; &quot;cl&quot; ...
##   .. ..$ d_r                 : num [1:56] 0.58 0.616 0.637 0.637 0.637 ...
##   .. ..$ d_g                 : num [1:56] 0.462 0.452 0.441 0.441 0.441 ...
##   .. ..$ d_b                 : num [1:56] 0.313 0.218 0.248 0.248 0.248 ...
##   .. ..$ d_hue               : chr [1:56] &quot;10YR&quot; &quot;10YR&quot; &quot;7.5YR&quot; &quot;7.5YR&quot; ...
##   .. ..$ d_value             : num [1:56] 5 5 5 5 5 NA 6 6 5 5 ...
##   .. ..$ d_chroma            : num [1:56] 4 6 6 6 6 NA 6 6 6 6 ...
##   .. ..$ d_sigma             : num [1:56] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ m_r                 : num [1:56] 0.471 0.383 0.541 0.541 0.541 ...
##   .. ..$ m_g                 : num [1:56] 0.359 0.257 0.331 0.331 0.331 ...
##   .. ..$ m_b                 : num [1:56] 0.268 0.151 0.185 0.185 0.185 ...
##   .. ..$ m_hue               : chr [1:56] &quot;7.5YR&quot; &quot;7.5YR&quot; &quot;5YR&quot; &quot;5YR&quot; ...
##   .. ..$ m_value             : num [1:56] 4 3 4 4 4 NA 5 5 4 4 ...
##   .. ..$ m_chroma            : num [1:56] 3 4 6 6 6 NA 6 6 6 6 ...
##   .. ..$ m_sigma             : num [1:56] NA NA NA NA NA NA NA NA NA NA ...
##   .. ..$ moist_soil_color    : chr [1:56] &quot;#785C44&quot; &quot;#624126&quot; &quot;#8A542F&quot; &quot;#8A542F&quot; ...
##   .. ..$ dry_soil_color      : chr [1:56] &quot;#947650&quot; &quot;#9D7338&quot; &quot;#A3703F&quot; &quot;#A3703F&quot; ...
##   .. ..$ fine_gravel         : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ gravel              : num [1:56] 0 5 5 5 0 0 0 5 5 5 ...
##   .. ..$ cobbles             : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ stones              : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ boulders            : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ channers            : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ flagstones          : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ parafine_gravel     : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ paragravel          : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ paracobbles         : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ parastones          : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ paraboulders        : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ parachanners        : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ paraflagstones      : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ unspecified         : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ total_frags_pct_nopf: num [1:56] 0 5 5 5 0 0 0 5 5 5 ...
##   .. ..$ total_frags_pct     : num [1:56] 0 5 5 5 0 0 0 5 5 5 ...
##   .. ..$ art_fgr             : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ art_gr              : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ art_cb              : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ art_st              : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ art_by              : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ art_ch              : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ art_fl              : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ art_unspecified     : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ total_art_pct       : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ huartvol_cohesive   : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ huartvol_penetrable : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ huartvol_innocuous  : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ huartvol_persistent : num [1:56] 0 0 0 0 0 0 0 0 0 0 ...
##   .. ..$ soil_color          : chr [1:56] &quot;#785C44&quot; &quot;#624126&quot; &quot;#8A542F&quot; &quot;#8A542F&quot; ...
##   .. ..$ hzID                : chr [1:56] &quot;652&quot; &quot;653&quot; &quot;654&quot; &quot;655&quot; ...
##   ..@ site        :&#39;data.frame&#39;: 10 obs. of  114 variables:
##   .. ..$ peiid                                   : chr [1:10] &quot;115595&quot; &quot;115819&quot; &quot;115827&quot; &quot;1193371&quot; ...
##   .. ..$ siteiid                                 : int [1:10] 114622 159118 159056 1231724 254459 209260 269617 307647 308029 308033
##   .. ..$ pedon_id                                : chr [1:10] &quot;300J&quot; &quot;S2000CA007009&quot; &quot;S2000CA007012&quot; &quot;2017CA6306054N&quot; ...
##   .. ..$ site_id                                 : chr [1:10] &quot;300J&quot; &quot;300J&quot; &quot;716Q&quot; &quot;2017CA6306054N&quot; ...
##   .. ..$ obs_date                                : POSIXct[1:10], format: &quot;1999-06-21 04:00:00&quot; &quot;1999-06-21 04:00:00&quot; ...
##   .. ..$ utmzone                                 : int [1:10] 10 10 10 NA 10 10 10 10 10 10
##   .. ..$ utmeasting                              : num [1:10] 634515 634515 633987 NA 729321 ...
##   .. ..$ utmnorthing                             : num [1:10] 4367113 4367113 4375530 NA 4204365 ...
##   .. ..$ x                                       : num [1:10] -121 -121 -121 NA -120 ...
##   .. ..$ y                                       : num [1:10] 39.4 39.4 39.5 NA 38 ...
##   .. ..$ horizdatnm                              : chr [1:10] &quot;NAD83&quot; &quot;NAD83&quot; &quot;NAD83&quot; NA ...
##   .. ..$ x_std                                   : num [1:10] -121 -121 -121 -120 -120 ...
##   .. ..$ y_std                                   : num [1:10] 39.4 39.4 39.5 37.9 38 ...
##   .. ..$ gpspositionalerror                      : num [1:10] NA NA NA NA NA NA NA NA NA NA
##   .. ..$ describer                               : chr [1:10] &quot;Felix J. Panlasigui Jr.&quot; &quot;Felix Panlasigui&quot; &quot;DWB&quot; &quot;Andrew Brown&quot; ...
##   .. ..$ pedonpurpose                            : chr [1:10] &quot;full pedon description&quot; &quot;full pedon description&quot; &quot;full pedon description&quot; NA ...
##   .. ..$ pedontype                               : chr [1:10] &quot;representative pedon for component&quot; &quot;representative pedon for component&quot; &quot;OSD pedon&quot; NA ...
##   .. ..$ pedlabsampnum                           : chr [1:10] &quot;01N0263&quot; &quot;01N0263&quot; &quot;01N0266&quot; NA ...
##   .. ..$ labdatadescflag                         : int [1:10] 0 0 0 0 1 0 0 0 0 0
##   .. ..$ tsectstopnum                            : int [1:10] NA NA NA NA NA 1 NA NA NA NA
##   .. ..$ tsectinterval                           : num [1:10] NA NA NA NA NA 30 NA NA NA NA
##   .. ..$ utransectid                             : logi [1:10] NA NA NA NA NA NA ...
##   .. ..$ tsectkind                               : chr [1:10] NA NA NA NA ...
##   .. ..$ tsectselmeth                            : chr [1:10] NA NA NA NA ...
##   .. ..$ elev_field                              : num [1:10] 201 201 365 422 536 408 328 150 280 320
##   .. ..$ slope_field                             : num [1:10] 8 8 18 NA 45 25 9 NA 5 3
##   .. ..$ aspect_field                            : int [1:10] 152 152 290 NA 120 145 344 NA 90 238
##   .. ..$ plantassocnm                            : chr [1:10] NA NA NA NA ...
##   .. ..$ earthcovkind1                           : chr [1:10] NA NA NA NA ...
##   .. ..$ earthcovkind2                           : chr [1:10] NA NA NA NA ...
##   .. ..$ erocl                                   : chr [1:10] NA NA NA NA ...
##   .. ..$ bedrckdepth                             : int [1:10] 74 74 107 80 99 73 64 NA NA NA
##   .. ..$ bedrckkind                              : chr [1:10] &quot;metavolcanics&quot; &quot;metavolcanics&quot; &quot;metavolcanics&quot; &quot;greenstone&quot; ...
##   .. ..$ bedrckhardness                          : chr [1:10] NA NA NA &quot;moderately&quot; ...
##   .. ..$ hillslopeprof                           : chr [1:10] NA NA NA NA ...
##   .. ..$ geomslopeseg                            : chr [1:10] NA NA NA NA ...
##   .. ..$ shapeacross                             : Factor w/ 5 levels &quot;concave&quot;,&quot;linear&quot;,..: 1 1 NA NA 1 2 1 NA 2 NA
##   .. ..$ shapedown                               : Factor w/ 5 levels &quot;concave&quot;,&quot;linear&quot;,..: NA NA NA NA 2 2 3 NA 3 NA
##   .. ..$ slopecomplex                            : chr [1:10] NA NA NA NA ...
##   .. ..$ drainagecl                              : chr [1:10] NA NA &quot;well&quot; NA ...
##   .. ..$ flodfreqcl                              : chr [1:10] NA NA NA NA ...
##   .. ..$ floddurcl                               : chr [1:10] NA NA NA NA ...
##   .. ..$ flodmonthbeg                            : chr [1:10] NA NA NA NA ...
##   .. ..$ pondfreqcl                              : chr [1:10] NA NA NA NA ...
##   .. ..$ ponddurcl                               : chr [1:10] NA NA NA NA ...
##   .. ..$ pondmonthbeg                            : chr [1:10] NA NA NA NA ...
##   .. ..$ geomposhill                             : chr [1:10] NA NA NA &quot;side slope&quot; ...
##   .. ..$ geomposmntn                             : chr [1:10] NA NA NA NA ...
##   .. ..$ geomposflats                            : chr [1:10] NA NA NA NA ...
##   .. ..$ swaterdepth                             : int [1:10] NA NA NA NA NA NA NA NA NA NA
##   .. ..$ slope_shape                             : Factor w/ 9 levels &quot;concave / convex&quot;,..: NA NA NA NA 2 5 1 NA 4 NA
##   .. ..$ classdate                               : POSIXct[1:10], format: &quot;2012-07-24 04:02:22&quot; &quot;2011-07-03 09:18:06&quot; ...
##   .. ..$ classifier                              : chr [1:10] NA NA NA &quot;Andrew Brown&quot; ...
##   .. ..$ classtype                               : chr [1:10] &quot;correlated&quot; &quot;correlated&quot; &quot;correlated&quot; &quot;field&quot; ...
##   .. ..$ taxonname                               : chr [1:10] &quot;LOAFERCREEK&quot; &quot;LOAFERCREEK&quot; &quot;Loafercreek&quot; &quot;Loafercreek&quot; ...
##   .. ..$ localphase                              : chr [1:10] NA NA NA NA ...
##   .. ..$ taxonkind                               : chr [1:10] &quot;series&quot; &quot;series&quot; &quot;series&quot; &quot;series&quot; ...
##   .. ..$ seriesstatus                            : chr [1:10] NA NA NA NA ...
##   .. ..$ taxpartsize                             : chr [1:10] &quot;fine-loamy&quot; &quot;fine-loamy&quot; &quot;fine-loamy&quot; NA ...
##   .. ..$ taxorder                                : chr [1:10] &quot;alfisols&quot; &quot;alfisols&quot; &quot;alfisols&quot; NA ...
##   .. ..$ taxsuborder                             : chr [1:10] &quot;xeralfs&quot; &quot;xeralfs&quot; &quot;xeralfs&quot; NA ...
##   .. ..$ taxgrtgroup                             : chr [1:10] &quot;haploxeralfs&quot; &quot;haploxeralfs&quot; &quot;haploxeralfs&quot; NA ...
##   .. ..$ taxsubgrp                               : chr [1:10] &quot;ultic haploxeralfs&quot; &quot;typic haploxeralfs&quot; &quot;ultic haploxeralfs&quot; NA ...
##   .. ..$ soiltaxedition                          : chr [1:10] &quot;eighth edition&quot; &quot;eighth edition&quot; &quot;ninth edition&quot; NA ...
##   .. ..$ osdtypelocflag                          : int [1:10] 0 0 0 0 0 0 0 0 0 0
##   .. ..$ taxmoistcl                              : chr [1:10] &quot;xeric&quot; &quot;xeric&quot; &quot;xeric&quot; NA ...
##   .. ..$ taxtempregime                           : chr [1:10] &quot;thermic&quot; &quot;thermic&quot; &quot;thermic&quot; NA ...
##   .. ..$ taxfamother                             : chr [1:10] NA NA &quot;not used&quot; NA ...
##   .. ..$ psctopdepth                             : int [1:10] 10 10 15 NA 25 13 23 NA 30 28
##   .. ..$ pscbotdepth                             : int [1:10] 61 61 65 NA 99 63 64 NA 58 61
##   .. ..$ selection_method                        : chr [1:10] &quot;most recent&quot; &quot;most recent&quot; &quot;most recent&quot; &quot;single record&quot; ...
##   .. ..$ ecositeid                               : chr [1:10] NA NA NA NA ...
##   .. ..$ ecositenm                               : chr [1:10] NA NA NA NA ...
##   .. ..$ ecositecorrdate                         : POSIXct[1:10], format: NA NA ...
##   .. ..$ es_classifier                           : chr [1:10] NA NA NA NA ...
##   .. ..$ es_selection_method                     : chr [1:10] NA NA NA NA ...
##   .. ..$ ochric.epipedon                         : logi [1:10] TRUE TRUE TRUE NA TRUE TRUE ...
##   .. ..$ argillic.horizon                        : logi [1:10] TRUE TRUE TRUE NA FALSE TRUE ...
##   .. ..$ paralithic.contact                      : logi [1:10] TRUE TRUE TRUE NA TRUE TRUE ...
##   .. ..$ lithic.contact                          : logi [1:10] FALSE FALSE TRUE NA FALSE FALSE ...
##   .. ..$ umbric.epipedon                         : logi [1:10] FALSE FALSE FALSE NA FALSE FALSE ...
##   .. ..$ cambic.horizon                          : logi [1:10] FALSE FALSE FALSE NA TRUE FALSE ...
##   .. ..$ mollic.epipedon                         : logi [1:10] FALSE FALSE FALSE NA FALSE FALSE ...
##   .. ..$ paralithic.materials                    : logi [1:10] FALSE FALSE FALSE NA FALSE FALSE ...
##   .. ..$ lithologic.discontinuity                : logi [1:10] FALSE FALSE FALSE NA FALSE FALSE ...
##   .. ..$ andic.soil.properties                   : logi [1:10] FALSE FALSE FALSE NA FALSE FALSE ...
##   .. ..$ densic.contact                          : logi [1:10] FALSE FALSE FALSE NA FALSE FALSE ...
##   .. ..$ abrupt.textural.change                  : logi [1:10] FALSE FALSE FALSE NA FALSE FALSE ...
##   .. ..$ aquic.conditions                        : logi [1:10] FALSE FALSE FALSE NA FALSE FALSE ...
##   .. ..$ duripan                                 : logi [1:10] FALSE FALSE FALSE NA FALSE FALSE ...
##   .. ..$ slickensides                            : logi [1:10] FALSE FALSE FALSE NA FALSE FALSE ...
##   .. ..$ redox.depletions.with.chroma.2.or.less  : logi [1:10] FALSE FALSE FALSE NA FALSE FALSE ...
##   .. ..$ redox.concentrations                    : logi [1:10] FALSE FALSE FALSE NA FALSE FALSE ...
##   .. ..$ reduced.matrix                          : logi [1:10] FALSE FALSE FALSE NA FALSE FALSE ...
##   .. ..$ densic.materials                        : logi [1:10] FALSE FALSE FALSE NA FALSE FALSE ...
##   .. ..$ volcanic.glass                          : logi [1:10] FALSE FALSE FALSE NA FALSE FALSE ...
##   .. ..$ folistic.epipedon                       : logi [1:10] FALSE FALSE FALSE NA FALSE FALSE ...
##   .. ..$ albic.materials                         : logi [1:10] FALSE FALSE FALSE NA FALSE FALSE ...
##   .. ..$ human.transported.material              : logi [1:10] FALSE FALSE FALSE NA FALSE FALSE ...
##   .. .. [list output truncated]
##   ..@ sp          :Formal class &#39;SpatialPoints&#39; [package &quot;sp&quot;] with 3 slots
##   .. .. ..@ coords     : num [1, 1] 0
##   .. .. ..@ bbox       : logi [1, 1] NA
##   .. .. ..@ proj4string:Formal class &#39;CRS&#39; [package &quot;sp&quot;] with 1 slot
##   .. .. .. .. ..@ projargs: chr NA
##   ..@ diagnostic  :&#39;data.frame&#39;: 26 obs. of  4 variables:
##   .. ..$ peiid   : int [1:26] 115595 115595 115595 115819 115819 115819 115827 115827 115827 115827 ...
##   .. ..$ featkind: chr [1:26] &quot;ochric epipedon&quot; &quot;argillic horizon&quot; &quot;paralithic contact&quot; &quot;ochric epipedon&quot; ...
##   .. ..$ featdept: int [1:26] 0 10 74 0 10 74 1 15 79 107 ...
##   .. ..$ featdepb: int [1:26] 10 74 81 10 74 81 5 79 107 NA ...
##   ..@ restrictions:&#39;data.frame&#39;: 9 obs. of  8 variables:
##   .. ..$ peiid   : int [1:9] 115595 115819 115827 115827 207242 207255 268820 307957 307961
##   .. ..$ resdept : int [1:9] 74 74 79 107 99 73 64 58 61
##   .. ..$ resdepb : int [1:9] 81 81 107 NA 203 97 NA 83 86
##   .. ..$ resthk_l: int [1:9] NA NA NA NA NA NA NA NA NA
##   .. ..$ resthk_r: int [1:9] 7 7 NA NA 104 24 NA 25 25
##   .. ..$ resthk_h: int [1:9] NA NA NA NA NA NA NA NA NA
##   .. ..$ reskind : chr [1:9] &quot;bedrock, paralithic&quot; &quot;bedrock, paralithic&quot; &quot;bedrock, paralithic&quot; &quot;bedrock, lithic&quot; ...
##   .. ..$ reshard : chr [1:9] NA NA &quot;strongly&quot; NA ...</code></pre>
<pre class="r"><code># Agrupar perfis pela posição na paisagem
#groupedProfilePlot(x, groups=&#39;hillslopeprof&#39;, label=&#39;pedon_id&#39;, id.style=&#39;side&#39;)

# Carregando onconjunto de dados de solos mineralKing
data(&quot;mineralKing&quot;)
par(mar=c(1,1,2,1))
groupedProfilePlot(mineralKing, groups=&#39;taxonname&#39;, print.id=FALSE)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-11-3.png" width="672" /></p>
<pre class="r"><code># plot de distância ao longo de um transecto
coordinates(mineralKing) &lt;- ~ x_std + y_std
# defina o sistema de coordenada de referência (CRS)
proj4string(mineralKing) &lt;- &#39;+proj=longlat +datum=NAD83&#39;
crs.utm &lt;- CRS(&#39;+proj=utm +zone=11 +datum=NAD83&#39;) #reprojetando para utm metros
par(mar=c(4.5,4,1,1))

# plot Padrão
plotTransect(mineralKing, grad.var.name = &#39;elev_field&#39;, crs = crs.utm)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-11-4.png" width="672" /></p>
<pre class="r"><code># plot com alteração de tamanho e tipo de fonte e nome dos eixos
plotTransect(mineralKing, grad.var.name=&#39;elev_field&#39;, crs=crs.utm, grad.axis.title=&#39;Elevação (m)&#39;, 
             distance.axis.title=&#39;Distância ao longo do transecto (km)&#39;,
             label=&#39;pedon_id&#39;, scaling.factor = 0.5,
             cex.names=0.8,cex.id=0.8,col.legend.cex=1.5,family=&quot;serif&quot;)</code></pre>
<p><img src="{{< blogdown/postref >}}index_files/figure-html/unnamed-chunk-11-5.png" width="672" />
### Se você chegou até aqui muito bem !!!! 👏👏👏</p>
</div>
<div id="referências" class="section level1 unnumbered">
<h1>Referências</h1>
<div id="refs" class="references csl-bib-body hanging-indent">
<div id="ref-Arrouays2017" class="csl-entry">
Arrouays, D., Leenaars, J.G.B., Richer-de-Forges, A.C., Adhikari, K., Ballabio, C., Greve, M., Grundy, M., Guerrero, E., Hempel, J., Hengl, T., Heuvelink, G., Batjes, N., Carvalho, E., Hartemink, A., Hewitt, A., Hong, S.Y., Krasilnikov, P., Lagacherie, P., Lelyk, G., Libohova, Z., Lilly, A., McBratney, A., McKenzie, N., Vasquez, G.M., Mulder, V.L., Minasny, B., Montanarella, L., Odeh, I., Padarian, J., Poggio, L., Roudier, P., Saby, N., Savin, I., Searle, R., Solbovoy, V., Thompson, J., Smith, S., Sulaeman, Y., Vintila, R., Rossel, R.V., Wilson, P., Zhang, G.L., Swerts, M., Oorts, K., Karklins, A., Feng, L., Ibelles Navarro, A.R., Levin, A., Laktionova, T., Dell’Acqua, M., Suvannang, N., Ruam, W., Prasad, J., Patil, N., Husnjak, S., Pásztor, L., Okx, J., Hallet, S., Keay, C., Farewell, T., Lilja, H., Juilleret, J., Marx, S., Takata, Y., Kazuyuki, Y., Mansuy, N., Panagos, P., Van Liedekerke, M., Skalsky, R., Sobocka, J., Kobza, J., Eftekhari, K., Alavipanah, S.K., Moussadek, R., Badraoui, M., Da Silva, M., Paterson, G., Gonçalves, M. da C., Theocharopoulos, S., Yemefack, M., Tedou, S., Vrscaj, B., Grob, U., Kozák, J., Boruvka, L., Dobos, E., Taboada, M., Moretti, L., Rodriguez, D., 2017. <span class="nocase">Soil legacy data rescue via GlobalSoilMap and other international and national initiatives</span>. GeoResJ 14, 1–19. <a href="https://doi.org/10.1016/j.grj.2017.06.001">https://doi.org/10.1016/j.grj.2017.06.001</a>
</div>
<div id="ref-Beaudette2013" class="csl-entry">
Beaudette, D.E., Roudier, P., O’Geen, A.T., 2013. <span class="nocase">Algorithms for quantitative pedology: A toolkit for soil scientists</span>. Computers and Geosciences 52, 258–268. <a href="https://doi.org/10.1016/j.cageo.2012.10.020">https://doi.org/10.1016/j.cageo.2012.10.020</a>
</div>
<div id="ref-Pinheiro2016" class="csl-entry">
Pinheiro, H.S.K., Chagas, C. da S., Carvalho Junior, W., Anjos, L.H.C., 2016. <span class="nocase">Ferramentas de pedometria para caracteriza<span class="nocase">ç</span><span class="nocase">ã</span>o da composi<span class="nocase">ç</span><span class="nocase">ã</span>o granulom<span class="nocase">é</span>trica de perfis de solos hidrom<span class="nocase">ó</span>rficos</span>. Pesquisa Agropecu<span>á</span>ria Brasileira 51, 1326–1338. <a href="https://doi.org/10.1590/S0100-204X2016000900032">https://doi.org/10.1590/S0100-204X2016000900032</a>
</div>
<div id="ref-Pinheiro2018" class="csl-entry">
Pinheiro, H.S.K., Helena, L., Anjos, C., Xavier, P.A.M., Cesar, S., 2018. <span class="nocase">Quantitative pedology to evaluate a soil profile collection from the Brazilian semi-arid region</span>. South African Journal of Geomatics 1862, 1–11. <a href="https://doi.org/10.1080/02571862.2017.1419385">https://doi.org/10.1080/02571862.2017.1419385</a>
</div>
<div id="ref-R2019" class="csl-entry">
R Core Team, 2019. <span class="nocase">R: A Language and Environment for Statistical Computing</span>.
</div>
</div>
</div>
